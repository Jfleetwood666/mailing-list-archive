<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="C2775058371b8e9c1d60047d3c687f7fa0ff1eac08eb9b6e419801edcb5e3041" /><meta name="keywords" content="C2775058371b8e9c1d60047d3c687f7fa0ff1eac08eb9b6e419801edcb5e3041, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="C2775058371b8e9c1d60047d3c687f7fa0ff1eac08eb9b6e419801edcb5e3041" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1995/07/c2775058371b8e9c1d60047d3c687f7fa0ff1eac08eb9b6e419801edcb5e3041/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="C2775058371b8e9c1d60047d3c687f7fa0ff1eac08eb9b6e419801edcb5e3041"><meta name="twitter:url" content="http://localhost:4000/archive/1995/07/c2775058371b8e9c1d60047d3c687f7fa0ff1eac08eb9b6e419801edcb5e3041/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1995-07-16---re-ssh-security-hole-proposed-fix">1995-07-16 - Re: Ssh “security hole”: proposed fix</h1><h2 id="header-data">Header Data</h2><p>From: David Mazieres &lt;mazieres<span>@</span>pa.dec.com&gt;<br /> To: ylo@cs.hut.fi<br /> Message Hash: c2775058371b8e9c1d60047d3c687f7fa0ff1eac08eb9b6e419801edcb5e3041<br /> Message ID: &lt;9507160615.AA06186@venus.pa.dec.com&gt;<br /> Reply To: &lt;199507151502.SAA01269@shadows.cs.hut.fi&gt;<br /> UTC Datetime: 1995-07-16 06:20:57 UTC<br /> Raw Date: Sat, 15 Jul 95 23:20:57 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: David Mazieres &lt;mazieres@pa.dec.com&gt;
Date: Sat, 15 Jul 95 23:20:57 PDT
To: ylo@cs.hut.fi
Subject: Re: Ssh "security hole": proposed fix
In-Reply-To: &lt;199507151502.SAA01269@shadows.cs.hut.fi&gt;
Message-ID: &lt;9507160615.AA06186@venus.pa.dec.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


Well, here is the proposed new ssh protocol as I understand it.

  A -&gt; B: A
  
  B -&gt; A: PKb, PKsb, Cb

    session_id := {PKb, PKsb, Cb}_MD5
  
  A -&gt; B: Cb, {{session_id XOR Kab}_PKsb}_PKb        (*)
  A -&gt; B: {A}_Kab
  A -&gt; B: {PKa}_Kab
  
  B -&gt; A: {{Nb}_PKa}_Kab
  
  A -&gt; B: {{Nb, session_id}_MD5}_Kab

It does seem to solve the two problems I pointed out.  However, I am
troubled by how complicated the protocol is, and how much encryption
is going on.  One of the principles I have heard stated says that more
encryption does not mean more security.  A good example of that seems
be the session key PKsb above.

In line (*) of the protocol, you say the session key (or now I guess
really session_id XOR Kab) is encrypted first with whichever of Kb,
Ksb has the larger modulus.  Under normal circumstances (the ones
depicted above), the first encryption will be with PKsb.  However, if
ever PKb were to come first, then PKsb would be completely vulnerable
to a "man in the middle" attack, and thus would be completely useless.

Wouldn't it make sense to simplify the protocol significantly, so as
to make it easier to understand and easier for us to convince
ourselves of its robustness?  What about something like what follows
this message?

To come up with the protocol I appended, I took your protocol and
stuck the the full context of each message into the message itself, so
that none of the previous problems could occur.  Then I eliminated all
complications like double encryption and challenges that did not add
to the security of the protocol.  Now granted I'm no authentication
expert and could easily have made a mistake here, but at least it will
be easier to catch because the protocol is simpler.  Who know what the
implications of that XOR really are?

David


PREAMBLE:

(1)  A -&gt; B: A

(2)  B -&gt; A: Cb, PKsb, PKb

(3)  A -&gt; B: {Kab}_PKsb, {A, B, Cb}_Kab

(4)  B -&gt; A: {{A, B, Cb, Kab, PKsb}_SKb}_Kab


SSH_AUTH_RHOSTS:

(5)  A -&gt; B:  0

SSH_AUTH_RHOSTS_RSA:
SSH_AUTH_RSA:

(5)  A -&gt; B: {{A, B, Cb, Kab}_SKa, PKa}_Kab

SSH_AUTH_PASSWORD:

(5)  A -&gt; B: {Ka}_Kab





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1995/07">July 1995</a><li>Return to “<a href="/author/david_mazieres_mazieres_at_pa_dec_com_">David Mazieres &lt;mazieres<span>@</span>pa.dec.com&gt;</a>”<li><p>Return to “<a href="/author/tatu_ylonen_ylo_at_cs_hut_fi_">Tatu Ylonen &lt;ylo<span>@</span>cs.hut.fi&gt;</a>”<li><em>Unknown thread root</em><ul><li>1995-07-15 (Sat, 15 Jul 95 08:02:37 PDT) - <a href="/archive/1995/07/ee345a35108fab31247f31fbbd8d1a9b34aa5ad931c848208311fc172f0d4659">Ssh “security hole”: proposed fix</a> - <em>Tatu Ylonen &lt;ylo@cs.hut.fi&gt;</em><ul><li>1995-07-16 (Sat, 15 Jul 95 23:20:57 PDT) - Re: Ssh “security hole”: proposed fix - <em>David Mazieres &lt;mazieres@pa.dec.com&gt;</em></ul></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
