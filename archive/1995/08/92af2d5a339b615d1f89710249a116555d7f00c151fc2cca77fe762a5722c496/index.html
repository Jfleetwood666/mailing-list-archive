<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="92af2d5a339b615d1f89710249a116555d7f00c151fc2cca77fe762a5722c496" /><meta name="keywords" content="92af2d5a339b615d1f89710249a116555d7f00c151fc2cca77fe762a5722c496, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="92af2d5a339b615d1f89710249a116555d7f00c151fc2cca77fe762a5722c496" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1995/08/92af2d5a339b615d1f89710249a116555d7f00c151fc2cca77fe762a5722c496/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="92af2d5a339b615d1f89710249a116555d7f00c151fc2cca77fe762a5722c496"><meta name="twitter:url" content="http://localhost:4000/archive/1995/08/92af2d5a339b615d1f89710249a116555d7f00c151fc2cca77fe762a5722c496/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1995-08-30---netscapes-rng">1995-08-30 - Netscape’s RNG</h1><h2 id="header-data">Header Data</h2><p>From: Ian Goldberg &lt;iagoldbe<span>@</span>csclub.uwaterloo.ca&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: 92af2d5a339b615d1f89710249a116555d7f00c151fc2cca77fe762a5722c496<br /> Message ID: &lt;199508300512.BAA23185@calum.csclub.uwaterloo.ca&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1995-08-30 05:13:04 UTC<br /> Raw Date: Tue, 29 Aug 95 22:13:04 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Ian Goldberg &lt;iagoldbe@csclub.uwaterloo.ca&gt;
Date: Tue, 29 Aug 95 22:13:04 PDT
To: cypherpunks@toad.com
Subject: Netscape's RNG
Message-ID: &lt;199508300512.BAA23185@calum.csclub.uwaterloo.ca&gt;
MIME-Version: 1.0
Content-Type: text/plain


Someone on the list (sorry, I forget who), suggested that Netscape's RNG
be looked at to see if the secret part of the SSL RC4/40 master key could
be determined more directly.

I used gdb on the Solaris version.  SSL_GenerateRandomBytes() is called
when random bytes are needed.  It initializes the RNG, if necessary, and then
calls RNG_GenerateRandomBytes.

When I run "netscape https://banking.wellsfargo.com/",
SSL_GenerateRandomBytes() is called 3 times; the first time, 32 bytes
are produced (I don't know what they're for); the second time, 16 bytes
are produced (the Challenge data); the third time, 64 bytes are produced,
the first 16 of which are the master key (the first 11 of which are sent
in the clear, and the next 5 are our goal).

Here's my own hand-reverse-assembly of RNG_GenerateRandomBytes:
(Correctness not actually guaranteed in any way...)

-----8&lt;-----8&lt;-----
struct RNG
{
    unsigned char md5bytes[0x10];
    unsigned char randbytes[0x10];
    int size;
    void *md5data;
};

RNG_GenerateRandomBytes(struct RNG *i0, char *i1, int i2)
{
    char buf[0x20];
    int o1,o2;

    while (i2 &gt; i0-&gt;size)
    {
	memcpy(i1, &amp;(i0-&gt;randbytes)+0x10-i0-&gt;size, i0-&gt;size);
	i1 += i0-&gt;size;
	i2 -= io-&gt;size;
	if (err = MD5_Begin(i0-&gt;md5data)) return err;
	if (err = MD5_Update(i0-&gt;md5data, &amp;(i0-&gt;md5bytes), 0x10)) return err;
	if (err = MD5_End(i0-&gt;md5data, &amp;(i0-&gt;randbytes), buf, 0x10)) return err;
	i0-&gt;size = 0x10;
	o2 = 0;
	o1 = &amp;(i0-&gt;md5bytes[0x0f]);
	do
	{
	    if ((*o1)++) break;
	    --o1;
	} while (++o2 &lt;= 0x0f);
    }

    /* i2 &lt;= i0-&gt;size */
    memcpy(i1, &amp;(i0-&gt;randbytes)+0x10-i0-&gt;size, i2);
    i0-&gt;size -= i2;
    return 0;
}
-----8&lt;-----8&lt;-----

It looks like that Compilers course came in handy...

So it's not linear congruential.  I guess the next step is to figure out
how it's seeded, but that not for me to do (at least not tonight...).

Here's another question about a more direct method:
The 5 secret bytes are encrypted with the server's public (RSA?) key.
Does the server use the same public key every time?  How do you read
the public key, given the Certificate Data (what's the format of the
certificate)?  Is it feasible to try to attack the public key with a
massively parallel (Internet) factoring program (a la RSA-129)?
Assuming that the modulus is _big_, it still is worthy to note that,
unlike cracking individual challenges, cracking the public key will
compromise _all_ communications with that server (until they catch on
and pay $$$ for another key (I think?)).

Just some thoughts,

   - Ian "it's only 10pm _here_, but it's 2am in Nova Scotia!"




</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1995/08">August 1995</a><li><p>Return to “<a href="/authors/ian_goldberg_iagoldbe_at_csclub_uwaterloo_ca_">Ian Goldberg &lt;iagoldbe<span>@</span>csclub.uwaterloo.ca&gt;</a>”<li><p>1995-08-30 (Tue, 29 Aug 95 22:13:04 PDT) - Netscape’s RNG - <em>Ian Goldberg &lt;iagoldbe@csclub.uwaterloo.ca&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
