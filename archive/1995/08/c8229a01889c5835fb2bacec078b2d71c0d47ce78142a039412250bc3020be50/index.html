<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="C8229a01889c5835fb2bacec078b2d71c0d47ce78142a039412250bc3020be50" /><meta name="keywords" content="C8229a01889c5835fb2bacec078b2d71c0d47ce78142a039412250bc3020be50, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="C8229a01889c5835fb2bacec078b2d71c0d47ce78142a039412250bc3020be50" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1995/08/c8229a01889c5835fb2bacec078b2d71c0d47ce78142a039412250bc3020be50/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="C8229a01889c5835fb2bacec078b2d71c0d47ce78142a039412250bc3020be50"><meta name="twitter:url" content="http://localhost:4000/archive/1995/08/c8229a01889c5835fb2bacec078b2d71c0d47ce78142a039412250bc3020be50/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1995-08-09---s1-encryption-system-was-this-looked-like-it-might-be-interesting">1995-08-09 - “S1” encryption system (was: this looked like it might be interesting)</h1><h2 id="header-data">Header Data</h2><p>From: Hal &lt;hfinney<span>@</span>shell.portal.com&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: c8229a01889c5835fb2bacec078b2d71c0d47ce78142a039412250bc3020be50<br /> Message ID: &lt;199508092259.PAA10092@jobe.shell.portal.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1995-08-09 23:00:53 UTC<br /> Raw Date: Wed, 9 Aug 95 16:00:53 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Hal &lt;hfinney@shell.portal.com&gt;
Date: Wed, 9 Aug 95 16:00:53 PDT
To: cypherpunks@toad.com
Subject: "S1" encryption system (was: this looked like it might be interesting)
Message-ID: &lt;199508092259.PAA10092@jobe.shell.portal.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


I suppose the unstated implication is that this might be Skipjack.

I have looked at the program a bit and have a few observations:

There is an obvious typo in the "g" function, whose first parameter
should be 0 or 1, but which tests it for 0, 1, or 2.  This suggests an
amateur effort.  The coding style in general suggests a lack of familiarity
with C (absence of "for" loops, with equivalent "while" loops substituted).

The program appears to be based on a hardware-based description of the
algorithm, judging from comments and style.

The algorithm uses two fixed arrays F and G.  Comments indicate that F
was designed as four independent arrays F0, F1, F2, and F3.  These are
suposed to be non-linear.  Each takes 8 bits in and 8 bits out.  G is
two arrays, each 8 bits in and 1 bit out.  The comments indicate that
it is supposed to be "pseudo-linear".  G1 is the odd parity function.
G0[i] is 0 0 1 1 0 1 1 0 0 1 repeated over and over.  This is unusual
because it is period 10 (the second 5 bits are the inverse of the first
5).  I don't know whether there would be a more concise algorithmic
representation of G0.

Key size is 80 bits.  The program implements the ability to hold 5 keys
at once.  Block size is 64 bits.  The keys are expanded internally into a
large array.  I haven't looked at the key scheduling in detail.

The encrypt and decrypt block functions have fixed xor's applied to the
64 bits of input and output.  This appears to be cryptographically
useless (or at least not very useful), similar to the initial
permutation in DES.  It is curious that xor's are used here rather than
a permutation.  That may represent an attempt to design the cipher to
run well in software.

The encryption function itself is a modified Feistel type cipher, with
the blocks broken into 8 pieces and xor'd with functions involving F,
G, the key and other pieces in a reversable pattern.  The loop iterates
32 times but only two of the 8 pieces are changed each iteration so
each 8 bit piece actually gets modified only 8 times.  The pattern is:

	piece 6 modified by pieces 4, 5, 2, 3
	piece 7 modified by pieces 4, 5, 0, 1
	piece 0 modified by pieces 6, 7, 4, 5
	piece 1 modified by pieces 6, 7, 2, 3
	piece 2 modified by pieces 0, 1, 6, 7
	piece 3 modified by pieces 0, 1, 4, 5
	piece 4 modified by pieces 2, 3, 0, 1
	piece 5 modified by pieces 2, 3, 6, 7

repeated 8 times.  Decryption goes in the inverse order as is typical of
these ciphers.

The key is basically 80 bits, however there is a function S1_create_key
which pads it with 16 bits of 0 and then encrypts it with two overlapping
encryptions using the all-zeros key.  The resulting 96 bit key is then
fed as input to S1_load_key which decrypts it and checks for the 0's to
ensure validity.

I am not much of a cryptanalyst, but from what I understand the overall
security of a Feistel-type cipher like this depends a great deal on the
structure of the F (and in this case G) boxes.  I would not be at all
qualified to analyze those.  So potentially this may be a strong cipher
or it may be weak.  The actual implementation does as I remarked show
some signs of amateur programming skills.  In addition to the points
mentioned it is curious that the G arrays are initialized with a list of
256 values rather than taking advantage of the apparent regularities
noted.

Hal Finney
hfinney@shell.portal.com





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1995/08">August 1995</a><li>Return to “<a href="/authors/futplex_at_pseudonym_com_futplex_">futplex<span>@</span>pseudonym.com (Futplex)</a>”<li>Return to “<a href="/authors/hal_hfinney_at_shell_portal_com_">Hal &lt;hfinney<span>@</span>shell.portal.com&gt;</a>”<li>Return to “<a href="/authors/jon_lasser_jlasser_at_rwd_goucher_edu_">Jon Lasser &lt;jlasser<span>@</span>rwd.goucher.edu&gt;</a>”<li>Return to “<a href="/authors/josh_m_osborne_stripes_at_va_pubnix_com_">“Josh M. Osborne” &lt;stripes<span>@</span>va.pubnix.com&gt;</a>”<li>Return to “<a href="/authors/matt_blaze_mab_at_crypto_com_">Matt Blaze &lt;mab<span>@</span>crypto.com&gt;</a>”<li><p>Return to “<a href="/authors/solman_at_mit_edu">solman<span>@</span>MIT.EDU</a>”<li>1995-08-09 (Wed, 9 Aug 95 16:00:53 PDT) - “S1” encryption system (was: this looked like it might be interesting) - <em>Hal &lt;hfinney@shell.portal.com&gt;</em><ul><li>1995-08-09 (Wed, 9 Aug 95 16:51:42 PDT) - <a href="/archive/1995/08/c5cd0b52c8e4f2e24b139060efbe6e0286c08a387225c7a612805e9ce4fe0a39">Re: “S1” encryption system (was: this looked like it might be interesting)</a> - <em>Matt Blaze &lt;mab@crypto.com&gt;</em><ul><li>1995-08-10 (Wed, 9 Aug 95 18:05:40 PDT) - <a href="/archive/1995/08/ee67cd912f79b29d1c6a572060f78ade9a83707174bc7a2eaa0ac439750a7e77">Re: “S1” encryption system (was: this looked like it might be interesting)</a> - <em>solman@MIT.EDU</em><ul><li>1995-08-10 (Wed, 9 Aug 95 18:08:53 PDT) - <a href="/archive/1995/08/968c106021b92c9931e600a211150c5f53d5f84246d5b8469ba0a78a813637fe">Re: “S1” encryption system (was: this looked like it might be interesting)</a> - <em>Matt Blaze &lt;mab@crypto.com&gt;</em></ul><li>1995-08-10 (Wed, 9 Aug 95 23:19:09 PDT) - <a href="/archive/1995/08/1c0943e7258867b7fa1bd53ba11dad3fec1110e5f7e99b4b52fdedb92807563d">Re: “S1” encryption system (was: this looked like it might be interesting)</a> - <em>Jon Lasser &lt;jlasser@rwd.goucher.edu&gt;</em><ul><li>1995-08-10 (Thu, 10 Aug 95 01:45:34 PDT) - <a href="/archive/1995/08/246c87a30a63fcec049f615cf72f63efced8c2155a8538038a89f9043dd0163a">Re: “S1” encryption system (was: this looked like it might be interesting)</a> - <em>futplex@pseudonym.com (Futplex)</em></ul></ul><li>1995-08-10 (Wed, 9 Aug 95 17:59:48 PDT) - <a href="/archive/1995/08/3507ea9dd8bc68125541385ca9222c30ff7a60f5429a61afa31887d5f4f4c54f">Re: “S1” encryption system (was: this looked like it might be interesting)</a> - <em>“Josh M. Osborne” &lt;stripes@va.pubnix.com&gt;</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
