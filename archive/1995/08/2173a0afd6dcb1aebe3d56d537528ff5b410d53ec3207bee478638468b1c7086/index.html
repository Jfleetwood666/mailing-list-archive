<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="2173a0afd6dcb1aebe3d56d537528ff5b410d53ec3207bee478638468b1c7086" /><meta name="keywords" content="2173a0afd6dcb1aebe3d56d537528ff5b410d53ec3207bee478638468b1c7086, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="2173a0afd6dcb1aebe3d56d537528ff5b410d53ec3207bee478638468b1c7086" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1995/08/2173a0afd6dcb1aebe3d56d537528ff5b410d53ec3207bee478638468b1c7086/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="2173a0afd6dcb1aebe3d56d537528ff5b410d53ec3207bee478638468b1c7086"><meta name="twitter:url" content="http://localhost:4000/archive/1995/08/2173a0afd6dcb1aebe3d56d537528ff5b410d53ec3207bee478638468b1c7086/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1995-08-16---re-use-of-the-iv-in-des--stuffing-the-first-block-w-random-stuff">1995-08-16 - Re: Use of the IV in DES &amp; stuffing the first block w/ random stuff</h1><h2 id="header-data">Header Data</h2><p>From: “W. Kinney” &lt;kinney<span>@</span>bogart.Colorado.EDU&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: 2173a0afd6dcb1aebe3d56d537528ff5b410d53ec3207bee478638468b1c7086<br /> Message ID: &lt;199508161458.IAA12814@bogart.Colorado.EDU&gt;<br /> Reply To: &lt;SAA03523.199508152240@garotte.va.pubnix.com&gt;<br /> UTC Datetime: 1995-08-16 14:58:18 UTC<br /> Raw Date: Wed, 16 Aug 95 07:58:18 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: "W. Kinney" &lt;kinney@bogart.Colorado.EDU&gt;
Date: Wed, 16 Aug 95 07:58:18 PDT
To: cypherpunks@toad.com
Subject: Re: Use of the IV in DES &amp; stuffing the first block w/ random stuff
In-Reply-To: &lt;SAA03523.199508152240@garotte.va.pubnix.com&gt;
Message-ID: &lt;199508161458.IAA12814@bogart.Colorado.EDU&gt;
MIME-Version: 1.0
Content-Type: text/plain



&gt; &gt;You might want to do something fancy like choose a random salt,
&gt; &gt;use the salt for the IV, and use MD5(salt,human-selected-key) for the key.
&gt; &gt;This makes pre-computation much less useful (unless you're careless
&gt; &gt;and use MD5(key,salt) instead if MD5(salt,key)...), and means that
&gt; &gt;you use a different session key for each batch of stuff you encrypt,
&gt; &gt;even though you're using the same key.  If you're paranoid about replay
&gt; &gt;attacks, you could let some of the bits of the salt be random and some 
&gt; &gt;be a counter, and never accept a key smaller than the one from the
&gt; &gt;previous successfully-decrypted message.
&gt; 
&gt; Hmmmm, so I should put the salt in the clear at the start of the file?
&gt; This looks like an intresting idea.

What I do in Curve Encrypt for the Mac is use the MD5 of the pass phrase,
a 128-bit random salt (overkill is cheap here) and a one-byte counter field
passed repeatedly through MD5, like this:

&lt;bare key&gt; = MD5[&lt;pass phrase&gt;]
&lt;salt&gt; = 128 bits of randoms
&lt;counter&gt; = 0

MD5Init()
for (a tenth of a second)
	MD5Update[&lt;counter&gt;&lt;key&gt;&lt;salt&gt;&lt;key&gt;&lt;salt&gt;]
	&lt;counter&gt; = &lt;counter&gt; + 1

&lt;key&gt; = MD5Final()

At startup, the program determines how many iterations of MD5Update can be
accomplished in a tenth of a second on the current CPU, and the loop is run
that many times. The number of iterations and the salt are stored with the
encrypted file, in the clear. The point to the &lt;counter&gt;&lt;key&gt;&lt;salt&gt;&lt;key&gt;&lt;salt&gt;
concatenation is that this buffer is 65 bytes long, and MD5 works on 64-bit
blocks, so that the buffer is shifted by one byte in the MD5 block each
iteration, making precomputation of the MD5 addition steps more of a pain.
Also note that the buffer is _not_ repeatedly MD5-hashed, but repeatedly sent
to MD5Update() instead. This is out of fear that there might be fixed-points
in the hash algorithm.


                                    -- Will






</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1995/08">August 1995</a><li>Return to “<a href="/authors/bill_stewart_stewarts_at_ix_netcom_com_">Bill Stewart &lt;stewarts<span>@</span>ix.netcom.com&gt;</a>”<li>Return to “<a href="/authors/josh_m_osborne_stripes_at_va_pubnix_com_">“Josh M. Osborne” &lt;stripes<span>@</span>va.pubnix.com&gt;</a>”<li><p>Return to “<a href="/authors/w_kinney_kinney_at_bogart_colorado_edu_">“W. Kinney” &lt;kinney<span>@</span>bogart.Colorado.EDU&gt;</a>”<li>1995-08-15 (Tue, 15 Aug 95 13:44:22 PDT) - <a href="/archive/1995/08/d185570e9d7a7245f9070eb5b494c5beea36ce9c7900a351a9e790577f34602f">Re: Use of the IV in DES &amp; stuffing the first block w/ random stuff</a> - <em>Bill Stewart &lt;stewarts@ix.netcom.com&gt;</em><ul><li>1995-08-15 (Tue, 15 Aug 95 15:41:16 PDT) - <a href="/archive/1995/08/1077b6d5a515b48a9802c2f462d8b476d0552483268a46f21f35eb67f2531607">Re: Use of the IV in DES &amp; stuffing the first block w/ random stuff</a> - <em>“Josh M. Osborne” &lt;stripes@va.pubnix.com&gt;</em><ul><li>1995-08-16 (Wed, 16 Aug 95 07:58:18 PDT) - Re: Use of the IV in DES &amp; stuffing the first block w/ random stuff - <em>“W. Kinney” &lt;kinney@bogart.Colorado.EDU&gt;</em></ul></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
