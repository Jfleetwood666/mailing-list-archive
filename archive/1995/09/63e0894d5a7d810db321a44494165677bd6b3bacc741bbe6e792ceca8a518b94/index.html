<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="63e0894d5a7d810db321a44494165677bd6b3bacc741bbe6e792ceca8a518b94" /><meta name="keywords" content="63e0894d5a7d810db321a44494165677bd6b3bacc741bbe6e792ceca8a518b94, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="63e0894d5a7d810db321a44494165677bd6b3bacc741bbe6e792ceca8a518b94" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1995/09/63e0894d5a7d810db321a44494165677bd6b3bacc741bbe6e792ceca8a518b94/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="63e0894d5a7d810db321a44494165677bd6b3bacc741bbe6e792ceca8a518b94"><meta name="twitter:url" content="http://localhost:4000/archive/1995/09/63e0894d5a7d810db321a44494165677bd6b3bacc741bbe6e792ceca8a518b94/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1995-09-22---re-netscape-bug">1995-09-22 - Re: netscape bug</h1><h2 id="header-data">Header Data</h2><p>From: Bill Sommerfeld &lt;sommerfeld<span>@</span>orchard.medford.ma.us&gt;<br /> To: tomw@cthulhu.engr.sgi.com<br /> Message Hash: 63e0894d5a7d810db321a44494165677bd6b3bacc741bbe6e792ceca8a518b94<br /> Message ID: &lt;199509220208.CAA00564@orchard.medford.ma.us&gt;<br /> Reply To: &lt;199509212242.PAA04533@orac.engr.sgi.com&gt;<br /> UTC Datetime: 1995-09-22 02:19:20 UTC<br /> Raw Date: Thu, 21 Sep 95 19:19:20 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Bill Sommerfeld &lt;sommerfeld@orchard.medford.ma.us&gt;
Date: Thu, 21 Sep 95 19:19:20 PDT
To: tomw@cthulhu.engr.sgi.com
Subject: Re: netscape bug
In-Reply-To: &lt;199509212242.PAA04533@orac.engr.sgi.com&gt;
Message-ID: &lt;199509220208.CAA00564@orchard.medford.ma.us&gt;
MIME-Version: 1.0
Content-Type: text/plain


&gt; I question the accuracy of this.  The fingerd bug was that a string in
&gt; the static data area was read in with gets which could be overflowed.
&gt; At some point in memory after this input buffer was the string constant
&gt; that stored the name of the finger command.  What the Morris work did
&gt; was to overflow the input buffer and replace the string constant
&gt; "finger" with "csh".  When fingerd then exec'ed the command, that gave
&gt; you a shell running on the machine.

Nope, that wasn't it, either.

See the Eichin/Rochlis "tour of the worm" paper.  

I was visiting friends at MIT the night the worm hit.  After receiving
some confused and unspecific reports that the worm was getting in
through fingerd, I had a flash of insight as to how that might happen;
as it turned out, this insight was correct, and shortly thereafter, I
had reproduced a benign form of the fingerd attack.  As implemented by
the worm, it only worked on vaxes, but it could have worked on other
systems.

The buffer in question was on the stack, not in static storage.

The attacker wrote a long sequence of NOP's, followed by machine
instructions which implemented the equivalent of exec("/bin/sh"),
followed by the approximate stack address of the stack buffer; the
last address was at the right place to overwrite the saved PC field in
the stack frame.  When the routine "returned", it actually branched
into the runway of NOP's, and then exec'ed "/bin/sh".

Note that the actual stack address varied, as environment variables
(which tend to vary from installation to installation) are located at
the top of the stack.

As it turned out, the attack did not work on most Athena systems,
because the athena /etc/rc complex wound up using a large number of
environment variables which pushed the location of the stack frame in
question out of the range where the attack would have worked.

					- Bill





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1995/09">September 1995</a><li>Return to “<a href="/authors/bill_sommerfeld_sommerfeld_at_orchard_medford_ma_us_">Bill Sommerfeld &lt;sommerfeld<span>@</span>orchard.medford.ma.us&gt;</a>”<li>Return to “<a href="/authors/perry_e_metzger_perry_at_piermont_com_">“Perry E. Metzger” &lt;perry<span>@</span>piermont.com&gt;</a>”<li>Return to “<a href="/authors/ray_cromwell_rjc_at_clark_net_">Ray Cromwell &lt;rjc<span>@</span>clark.net&gt;</a>”<li><p>Return to “<a href="/authors/tomw_at_orac_engr_sgi_com_tom_weinstein_">tomw<span>@</span>orac.engr.sgi.com (Tom Weinstein)</a>”<li>1995-09-21 (Thu, 21 Sep 95 15:42:57 PDT) - <a href="/archive/1995/09/00901adc03d841f0d4b1ec0673fc4b565a1092ec5c55586fae9c70f111579add">netscape bug</a> - <em>tomw@orac.engr.sgi.com (Tom Weinstein)</em><ul><li>1995-09-22 (Thu, 21 Sep 95 19:19:20 PDT) - Re: netscape bug - <em>Bill Sommerfeld &lt;sommerfeld@orchard.medford.ma.us&gt;</em><li>1995-09-22 (Thu, 21 Sep 95 21:43:51 PDT) - <a href="/archive/1995/09/e37b3c2972118f59e43bb71523957ef6b41ee5c498f11f2d6355570b260cc1dc">Re: netscape bug</a> - <em>“Perry E. Metzger” &lt;perry@piermont.com&gt;</em><ul><li>1995-09-22 (Thu, 21 Sep 95 22:12:06 PDT) - <a href="/archive/1995/09/ba6ec4b9e1f97daeaa30bb12bc28a0e5cc35bb2cf062c0c922b95fe4c5fc7ffd">Re: netscape bug</a> - <em>Ray Cromwell &lt;rjc@clark.net&gt;</em></ul><li>1995-09-22 (Thu, 21 Sep 95 22:33:41 PDT) - <a href="/archive/1995/09/570ef46268d7d21db91a7f627d84938a371192b146e71962f1007c03380da6e0">Re: netscape bug</a> - <em>tomw@orac.engr.sgi.com (Tom Weinstein)</em><ul><li>1995-09-22 (Thu, 21 Sep 95 22:38:08 PDT) - <a href="/archive/1995/09/26a40e540ab3e2c72ffd360d25eb274dcf40e02663df751386fe4d84001b2057">Re: netscape bug</a> - <em>“Perry E. Metzger” &lt;perry@piermont.com&gt;</em></ul></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
