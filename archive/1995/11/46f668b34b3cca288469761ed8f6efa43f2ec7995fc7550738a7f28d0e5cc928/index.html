<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="46f668b34b3cca288469761ed8f6efa43f2ec7995fc7550738a7f28d0e5cc928" /><meta name="keywords" content="46f668b34b3cca288469761ed8f6efa43f2ec7995fc7550738a7f28d0e5cc928, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="46f668b34b3cca288469761ed8f6efa43f2ec7995fc7550738a7f28d0e5cc928" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1995/11/46f668b34b3cca288469761ed8f6efa43f2ec7995fc7550738a7f28d0e5cc928/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="46f668b34b3cca288469761ed8f6efa43f2ec7995fc7550738a7f28d0e5cc928"><meta name="twitter:url" content="http://localhost:4000/archive/1995/11/46f668b34b3cca288469761ed8f6efa43f2ec7995fc7550738a7f28d0e5cc928/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1995-11-21---re-cryptl99zip-free-encryption-library-for-dosunixwindows-fwd">1995-11-21 - Re: cryptl99.zip Free encryption library for DOS/UNIX/Windows (fwd)</h1><h2 id="header-data">Header Data</h2><p>From: Eric Young &lt;eay<span>@</span>mincom.oz.au&gt;<br /> To: Enzo Michelangeli &lt;enzo@ima.com&gt;<br /> Message Hash: 46f668b34b3cca288469761ed8f6efa43f2ec7995fc7550738a7f28d0e5cc928<br /> Message ID: &lt;Pine.SOL.3.91.951121220824.2627A-100000@orb&gt;<br /> Reply To: &lt;Pine.LNX.3.91.951121193458.8471B-100000@ima.net&gt;<br /> UTC Datetime: 1995-11-21 12:49:37 UTC<br /> Raw Date: Tue, 21 Nov 1995 20:49:37 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Eric Young &lt;eay@mincom.oz.au&gt;
Date: Tue, 21 Nov 1995 20:49:37 +0800
To: Enzo Michelangeli &lt;enzo@ima.com&gt;
Subject: Re: cryptl99.zip Free encryption library for DOS/UNIX/Windows (fwd)
In-Reply-To: &lt;Pine.LNX.3.91.951121193458.8471B-100000@ima.net&gt;
Message-ID: &lt;Pine.SOL.3.91.951121220824.2627A-100000@orb&gt;
MIME-Version: 1.0
Content-Type: text/plain


On Tue, 21 Nov 1995, Enzo Michelangeli wrote:
&gt; This encryption library provides a universal interface to a number of 
&gt; conventional-key encryption algorithms.  The library currently supports 
&gt; encryption algorithms and modes of MDC/SHS CFB, DES ECB, CBC, CFB, OFB, PCBC, 
&gt; triple DES ECB, CBC, CFB, OFB, IDEA ECB, CBC, CFB, OFB, RC4, SAFER ECB, CBC, 
&gt; CFB, OFB, and SAFER-SK ECB, CBC, CFB, OFB.  All encryption routines are 

:-) cute, the next version of SSLeay to be released will have the same 
thing, good to see great minds think alike (or is that simple minds 
seldom differ :-).

Currently the interface I will have is
EVP_EncryptInit(EVP_CIPHER_CTX *ctx,EVP_CIPHER *type,unsigned char *key,
	unsigned char *iv);
void EVP_EncryptUpdate(EVP_CIPHER_CTX *ctx,unsigned char *out,int *outl,
	unsigned char *in,int inl);
void EVP_EncryptFinal(EVP_CIPHER_CTX *ctx,unsigned char *out,int *outl);

with a string to bytes function,
int EVP_BytesToKey(EVP_CIPHER *type,EVP_MD *md,unsigned char *salt,
	unsigned char *data,int datal,int count,
	unsigned char *key,unsigned char *iv);

this is upward compatable with PKCS#5 and will generate a key and iv of 
the correct size depending on the EVP_CIPHER for a data string (the 
lengths are encoded in the EVP_CIPHER definition).
I also have all my Message digest routines using the same type of interface.

What makes this nice is that all my digital signature routines 
(open, seal, sign, verify etc) all take EVP_CIPHER and EVP_MD arguments 
so any cipher can be used and any MD can be used.  The ASN1 object 
identifiers are contained in the EVP_CIPHER/EVP_MD structures.

It also make the 'demo' program that supports all the above mentioned 
encryption modes (and also does base64 encoding/decoding) only 290 lines 
long :-).

Now, heres the rub, to use a cipher to encode in pkcs#7 (which is what
S/MIME is using) one needs to have an object identifier (for use in the
ASN1 encoding).  I know of very few object identifiers.

type			object identifier.
EVP_des_ecb		1 3 14 3 2 6
EVP_des_ede
EVP_des_ede3		1 2 840 113549 3 17 (or is this EVP_des_ede (2 keys))
EVP_des_cfb		1 3 14 3 2 9
EVP_des_ede_cfb
EVP_des_ede3_cfb
EVP_des_ofb		1 3 14 3 2 8
EVP_des_ede_ofb
EVP_des_ede3_ofb
EVP_des_cbc		1 3 14 3 2 7
EVP_des_ede_cbc
EVP_des_ede3_cbc
EVP_rc4			1 2 840 113549 3 4
EVP_idea_ecb
EVP_idea_cfb
EVP_idea_ofb
EVP_idea_cbc
MD_md2			1 2 840 113549 2 2
MD_md5			1 2 840 113549 2 5
MD_sha			1 3 14 3 2 18

Can anyone out there fill in the blanks?  I also supose the new version 
of SHA, SHA-1 will also have a different identifier as well which I will 
also need.

In the above, I always use 'ede' to refer to encrypt-decrypt-encrypt with 
2 keys and 'ede3' to refer to ede with three keys.

eric (on a quest for object identifiers... and to finish the next version
      of SSLeay before he goes on a long holiday...)





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1995/11">November 1995</a><li>Return to “<a href="/author/enzo_michelangeli_enzo_at_ima_com_">Enzo Michelangeli &lt;enzo<span>@</span>ima.com&gt;</a>”<li><p>Return to “<a href="/author/eric_young_eay_at_mincom_oz_au_">Eric Young &lt;eay<span>@</span>mincom.oz.au&gt;</a>”<li>1995-11-21 (Tue, 21 Nov 1995 19:55:14 +0800) - <a href="/archive/1995/11/c24e0030654b70f5c400eec9747c58e905646471f8f0c32e12cdc4cabd23facb">cryptl99.zip Free encryption library for DOS/UNIX/Windows (fwd)</a> - <em>Enzo Michelangeli &lt;enzo@ima.com&gt;</em><ul><li>1995-11-21 (Tue, 21 Nov 1995 20:49:37 +0800) - Re: cryptl99.zip Free encryption library for DOS/UNIX/Windows (fwd) - <em>Eric Young &lt;eay@mincom.oz.au&gt;</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
