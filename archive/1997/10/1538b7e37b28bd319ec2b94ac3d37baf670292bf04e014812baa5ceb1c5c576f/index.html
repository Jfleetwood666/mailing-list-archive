<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="1538b7e37b28bd319ec2b94ac3d37baf670292bf04e014812baa5ceb1c5c576f" /><meta name="keywords" content="1538b7e37b28bd319ec2b94ac3d37baf670292bf04e014812baa5ceb1c5c576f, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="1538b7e37b28bd319ec2b94ac3d37baf670292bf04e014812baa5ceb1c5c576f" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1997/10/1538b7e37b28bd319ec2b94ac3d37baf670292bf04e014812baa5ceb1c5c576f/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="1538b7e37b28bd319ec2b94ac3d37baf670292bf04e014812baa5ceb1c5c576f"><meta name="twitter:url" content="http://localhost:4000/archive/1997/10/1538b7e37b28bd319ec2b94ac3d37baf670292bf04e014812baa5ceb1c5c576f/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1997-10-07---unperfect-misty-algorithm-source-code">1997-10-07 - unperfect MISTY algorithm source code</h1><h2 id="header-data">Header Data</h2><p>From: “Nobuki Nakatuji” &lt;bd1011<span>@</span>hotmail.com&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: 1538b7e37b28bd319ec2b94ac3d37baf670292bf04e014812baa5ceb1c5c576f<br /> Message ID: &lt;19971007020703.3649.qmail@hotmail.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1997-10-07 02:24:50 UTC<br /> Raw Date: Tue, 7 Oct 1997 10:24:50 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: "Nobuki Nakatuji" &lt;bd1011@hotmail.com&gt;
Date: Tue, 7 Oct 1997 10:24:50 +0800
To: cypherpunks@toad.com
Subject: unperfect MISTY algorithm source code
Message-ID: &lt;19971007020703.3649.qmail@hotmail.com&gt;
MIME-Version: 1.0
Content-Type: text/plain



*// MISTY

typedef unsigned short ushort;
typedef unsigned char  uchar;

ushort EXTKEY[4][8];

static uchar S7[128]={
 27, 50, 51, 90, 59, 16, 23, 84, 91, 26,114,115,107, 44,102, 73,
 31, 36, 19,108, 55, 46, 63, 74, 93, 15, 64, 86, 37, 81, 28,  4,
 11, 70, 32, 13,123, 53, 68, 66, 43, 30, 65, 20, 75,121, 21,111,
 14, 85,  9, 54,116, 12,103, 83, 40, 10,126, 56,  2,  7, 96, 41,
 25, 18,101, 47, 48, 57,  8,104, 95,120, 42, 76,100, 69,117, 61,
 89, 72,  3, 87,124, 79, 98, 60, 29, 33, 94, 39,106,112, 77, 58,
  1,109,110, 99, 24,119, 35,  5, 38,118,  0, 49, 45,122,127, 97,
 80, 34, 17,  6, 71, 22, 82, 78,113, 62,105, 67, 52, 92, 88,125,};

static uchar S9[512]={
451,203,339,415,483,233,251, 53,385,185,276,491,307,  9, 45,211,
199,330, 55,126,235,356,403,472,163,286, 85, 44, 29,418,355,280,
331,338,466, 15, 43, 48,314,229,273,312,398, 99,227,200,500, 27,
  1,157,248,416,365,499, 28,326,125,209,130,490,387,301,244,414,
467,221,482,296,480,236, 89,145, 17,303, 38,220,176,396,271,503,
231,364,182,249,216,337,257,332,259,184,340,299,430, 23,113, 12,
 71, 88,127,420,308,297,132,349,413,434,419, 72,124, 81,458, 35,
317,423,357, 59, 66,218,402,206,193,107,159,497,300,388,250,406,
481,361,381, 49,384,266,148,474,390,318,284, 96,373,463,103,281,
                                .
                                .
                                .
                                .
                                .
120,  0,172,272,350,292,  2,444,162,234,112,508,278,348, 76,450};

#define FL_enc( k ){
r1 ^= r0 &amp; EXTKEY[0][k];
r3 ^= r2 &amp; EXTKEY[1][(k+2)&amp;7];
r0 ^= r1 | EXTKEY[1][(k+6)&amp;7];
r2 ^= r3 | EXTKEY[0][(k+4)&amp;7];
}

#define FL_enc( k ){
r0 ^= r1 | EXTKEY[0][k];
r2 ^= r3 | EXTKEY[1][(k+4)&amp;7];
r1 ^= r0 &amp; EXTKEY[1][(k+6)&amp;7];
r3 ^= r2 &amp; EXTKEY[0][(k+2)&amp;7];
}

#define FL_key( k ){
r0 = EXTKEY[0][k] &gt;&gt; 7;
r1 = EXTKEY[0][k] &amp; 0xf7;
r0 = S9[r0][k] ^ r1;
r1 = S7[r1][k] ^ ( r0 &amp; 0x7f );
r1 ^= EXTKEY[0][(k+1)&amp;7];
r0 ^= EXTKEY[0][(k+1)&amp;7] &amp; 0x1ff;
r0 = S9[r0] ^ r1;
EXTKEY[3][k] = r1;
EXTKEY[2][k] = r0;
EXTKEY[1][k] = r1 &lt;&lt; 9 ^ r0;
}

#define FI_txt( a0, a1, k ){
a1 = a0 &gt;&gt; 7;
a0 &amp;= 0x7f;
a1 = S9[a1][k] ^ a0;
r1 = S7[a0][k] ^ a1;
a1 ^= EXTKEY[2][k];
a0 ^= EXTKEY[3][k];
a0 &amp;= 0x7f;
a1 = S9[a1] ^ a0;
a1 ^= a0 &lt;&lt; 9;
}

#define FI_txt( a0, a1, a2, a3, k ){
t0 = a0 ^ EXTKEY[0][k];
FI_txt( t0, t1, (t+5)&amp;7 );
t1 ^= a1;
t2 = a1 ^ EXTKEY[0][(k+2)&amp;7];
FI_txt( t2, t0, (k+1)&amp;7 );
t0 ^= t1;
t1 = EXTKEY[0][(k+7)&amp;7];
FI_txt( t1, t2, (t+3)&amp;7 );
t2 ^= t0;
t0 ^= EXTKEY[0][(k+4)&amp;7];
a2 ^= t0;
a3 ^= t2;
}


*// MISTY

misty1( text, key, block, mode )
uchar *text,*key;
int    block,mode;
{

   register ushort t0, t1, t2;
   register ushort r0, r1, r2, r3;

/*** key scheduling ***/

EXTKEY[0][0] = (ushort)key[0],&lt;&lt;8 ^ (ushort)key[1];
EXTKEY[0][1] = (ushort)key[2],&lt;&lt;8 ^ (ushort)key[3];
EXTKEY[0][2] = (ushort)key[4],&lt;&lt;8 ^ (ushort)key[5];
EXTKEY[0][3] = (ushort)key[6],&lt;&lt;8 ^ (ushort)key[7];
EXTKEY[0][4] = (ushort)key[8],&lt;&lt;8 ^ (ushort)key[9];
EXTKEY[0][5] = (ushort)key[10],&lt;&lt;8 ^ (ushort)key[11];
EXTKEY[0][6] = (ushort)key[12],&lt;&lt;8 ^ (ushort)key[13];
EXTKEY[0][7] = (ushort)key[14],&lt;&lt;8 ^ (ushort)key[15];

FI_key( 0 );
FI_key( 1 );
FI_key( 2 );
FI_key( 3 );
FI_key( 4 );
FI_key( 5 );
FI_key( 6 );
FI_key( 7 );

/*** Data Randomizing ***/

if( !(mode &amp; 1) ){

/*** Encryption ***/

while( block-- &gt; 0 ){

r0 = (ushort)text[0],&lt;&lt;8 ^ (ushort)key[1];
r1 = (ushort)text[2],&lt;&lt;8 ^ (ushort)key[3];
r2 = (ushort)text[4],&lt;&lt;8 ^ (ushort)key[5];
r3 = (ushort)text[6],&lt;&lt;8 ^ (ushort)key[7];

FI_enc( 0 );
FO_txt( r0, r1, r2, r3, 0 );
FO_txt( r2, r3, r0, r1, 1 );
FI_enc( 1 );
FO_txt( r0, r1, r2, r3, 2 );
FO_txt( r2, r3, r0, r1, 3 );
FI_enc( 2 );
FO_txt( r0, r1, r2, r3, 4 );
FO_txt( r2, r3, r0, r1, 5 );
FI_enc( 3 );
FO_txt( r0, r1, r2, r3, 6 );
FO_txt( r2, r3, r0, r1, 7 );
FI_enc( 4 );

text[0] = r2 &gt;&gt; 8;
text[1] = r2 &amp; 0xff;
text[2] = r3 &gt;&gt; 8;
text[3] = r3 &amp; 0xff;
text[4] = r0 &gt;&gt; 8;
text[5] = r0 &amp; 0xff;
text[6] = r1 &gt;&gt; 8;
text[7] = r1 &amp; 0xff;

text += 8;
    }
}
elsa{

/*** Decryption ***/

while( block-- &gt; 0 ){

r0 = (ushort)text[0],&lt;&lt;8 ^ (ushort)key[1];
r1 = (ushort)text[2],&lt;&lt;8 ^ (ushort)key[3];
r2 = (ushort)text[4],&lt;&lt;8 ^ (ushort)key[5];
r3 = (ushort)text[6],&lt;&lt;8 ^ (ushort)key[7];

FI_enc( 4 );
FO_txt( r2, r3, r0, r1, 7 );
FO_txt( r0, r1, r2, r3, 6 );
FI_enc( 3 );
FO_txt( r2, r3, r0, r1, 5 );
FO_txt( r0, r1, r2, r3, 4 );
FI_enc( 2 );
FO_txt( r2, r3, r0, r1, 3 );
FO_txt( r0, r1, r2, r3, 2 );
FI_enc( 1 );
FO_txt( r2, r3, r0, r1, 1 );
FO_txt( r0, r1, r2, r3, 0 );
FI_enc( 0 );

text[0] = r2 &gt;&gt; 8;
text[1] = r2 &amp; 0xff;
text[2] = r3 &gt;&gt; 8;
text[3] = r3 &amp; 0xff;
text[4] = r0 &gt;&gt; 8;
text[5] = r0 &amp; 0xff;
text[6] = r1 &gt;&gt; 8;
text[7] = r1 &amp; 0xff;


        }
    }
}



______________________________________________________
Get Your Private, Free Email at http://www.hotmail.com






</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1997/10">October 1997</a><li><p>Return to “<a href="/authors/nobuki_nakatuji_bd1011_at_hotmail_com_">“Nobuki Nakatuji” &lt;bd1011<span>@</span>hotmail.com&gt;</a>”<li><p>1997-10-07 (Tue, 7 Oct 1997 10:24:50 +0800) - unperfect MISTY algorithm source code - <em>“Nobuki Nakatuji” &lt;bd1011@hotmail.com&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
