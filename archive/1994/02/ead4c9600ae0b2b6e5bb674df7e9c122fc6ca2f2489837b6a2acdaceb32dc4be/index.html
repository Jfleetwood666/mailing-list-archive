<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/static/img/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/static/img/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title>
    <meta name="author" content="cryptoanarchy.wiki" />
    <meta name="description" content="Ead4c9600ae0b2b6e5bb674df7e9c122fc6ca2f2489837b6a2acdaceb32dc4be" />
    <meta name="keywords" content="Ead4c9600ae0b2b6e5bb674df7e9c122fc6ca2f2489837b6a2acdaceb32dc4be, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
    <meta content="" property="fb:app_id">
    <meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name">

    

    
      <meta content="Ead4c9600ae0b2b6e5bb674df7e9c122fc6ca2f2489837b6a2acdaceb32dc4be" property="og:title">
      <meta content="article" property="og:type">
    

    
      <meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description">
    

    
      <meta content="http://localhost:4000/archive/1994/02/ead4c9600ae0b2b6e5bb674df7e9c122fc6ca2f2489837b6a2acdaceb32dc4be/" property="og:url">
    

    
      <meta content="2018-06-20T21:43:48+02:00" property="article:published_time">
      <meta content="http://localhost:4000/about/" property="article:author">
    

    
      <meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image">
    

    
      
    

    
      
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@_cryptoanarchy">
    <meta name="twitter:creator" content="@_cryptoanarchy">

    
      <meta name="twitter:title" content="Ead4c9600ae0b2b6e5bb674df7e9c122fc6ca2f2489837b6a2acdaceb32dc4be">
    

    
      <meta name="twitter:url" content="http://localhost:4000/archive/1994/02/ead4c9600ae0b2b6e5bb674df7e9c122fc6ca2f2489837b6a2acdaceb32dc4be/">
    

    
      <meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!">
    

    

    <!-- Font awesome icons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/static/css/syntax.css">
    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/super-search.css">
    <link rel="stylesheet" href="/static/css/thickbox.css">
    <link rel="stylesheet" href="/static/css/projects.css">
    <link rel="stylesheet" href="/static/css/main.css">

    
  </head>
  <body>
    <div class="container">
      <div class="col-sm-3">
        <div class="fixed-condition">
          <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a>
          <h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1>
          
            <div class="profile-about">
              Arise, you have nothing to lose but your barbed wire fences!
            </div>
          
          <div class="social">
            <ul>
              
                <li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a></li>
              
                <li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a></li>
              
                <li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></li>
              
            </ul>
          </div>
          <hr />
          <ul class="sidebar-nav">
            <strong>Navigation</strong>
            <li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a></li>
            <li><a href="/">Archive Home</a></li>
          </ul>
          <hr>
          <ul class="sidebar-nav">
            <strong>Similar Resources</strong>
            
              <li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a></li>
            
              <li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a></li>
            
              <li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></li>
            
          </ul>
        </div>
        <!-- end /.fixed-condition -->
      </div>
      <div class="col-sm-8 col-offset-1 main-layout">
        <h1 id="1994-02-07---re-magic-money-attack">1994-02-07 - RE: Magic Money attack</h1>

<h2 id="header-data">Header Data</h2>

<p>From: Hal &lt;hfinney@shell.portal.com&gt;<br />
To: cypherpunks@toad.com<br />
Message Hash: ead4c9600ae0b2b6e5bb674df7e9c122fc6ca2f2489837b6a2acdaceb32dc4be<br />
Message ID: &lt;199402070641.WAA27913@jobe.shell.portal.com&gt;<br />
Reply To: <em>N/A</em><br />
UTC Datetime: 1994-02-07 06:41:09 UTC<br />
Raw Date: Sun, 6 Feb 94 22:41:09 PST<br /></p>

<h2 id="raw-message">Raw message</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Hal &lt;hfinney@shell.portal.com&gt;
Date: Sun, 6 Feb 94 22:41:09 PST
To: cypherpunks@toad.com
Subject: RE: Magic Money attack
Message-ID: &lt;199402070641.WAA27913@jobe.shell.portal.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


From Pr0duct Cypher:

&gt; [ only 18 bytes are checked ]
&gt; 
&gt; Easy enough to fix. Will code this. I just sent new PGP Tools and Magic
&gt; Money updates to MPJ. He must be getting tired of me sending him new code
&gt; all the time. :-) The latest version does protect against garbling of the
&gt; message from client to server.

I think it's great that you are able to fix these things so quickly.
It's natural that there will be a lot of shaking out in any initial
release.

&gt; How many small primes would it take? How would he know what numbers to
&gt; multiply to get the coins? Just create random coins and look for one which
&gt; is made of all small factors? I should try this and see if I can find one.
&gt; Not being an expert in the math, would most coins have a large factor, or
&gt; would there be a fair number with only small factors?

Knuth has some discussion of this in Seminumerical Algorithms.  The term
for numbers which have only small factors is that they are "smooth".  He
has some formulas for what fraction of numbers are smooth based on the
size of the largest allowed prime and the size of the numbers.  Unfortunately
I won't have access to my copy until Tuesday.  Perhaps someone else can
look it up.

&gt; &gt;I don't know how this attack can be prevented.
&gt; 
&gt; I can think of one way. Redefine the coin format so the last 2 bytes or so
&gt; can be anything you want. Now when the user generates a coin, he sets these
&gt; last two bytes to 0001 and then tests for primality. He keeps adding 2 and 
&gt; checking until he finds a coin which is prime, or at least doesn't have any 
&gt; small factors.

Clever idea.  If only it wouldn't be so slow.

&gt; The small-factor sieve is fast, and with the proper #defines, it checks 
&gt; all primes below 8192 decimal. The slowtest() PGP uses is slow even for the
&gt; 512-bit primes used to make 1024 bit PGP keys. It would be useless for a
&gt; full 1024-bit number. Would eliminating coins with factors below 8192 be
&gt; enough? Or how could one more quickly check the coin for primality?

The 8192 cutoff might work.  We would have to check it out, but it
could be that finding 1024-bit numbers in a relatively narrow range of
+/- 2^64 which are composed solely of factors in the range, say, 8192
to 16384 would be infeasible.  I don't recall whether Knuth considers the
problem in this form.  This would be a great save if it works.

Hal





</code></pre></div></div>

<h2 id="thread">Thread</h2>

<ul>
  <li>
    <p>Return to <a href="/archive/1994/02">February 1994</a></p>
  </li>
  <li>
    <p>1994-02-07 (Sun, 6 Feb 94 22:41:09 PST) - RE: Magic Money attack - <em>Hal &lt;hfinney@shell.portal.com&gt;</em></p>
  </li>
</ul>


        <footer>
          
            - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a>
          
        </footer>
      </div>
      <!-- end /.col-sm-8 -->
    </div>
    <!-- end /.container -->

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/super-search.js"></script>
    <script src="/static/js/thickbox-compressed.js"></script>
    <script src="/static/js/projects.js"></script>
  </body>
</html>

