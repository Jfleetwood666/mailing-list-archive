<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="D2e6216bb11716f60e2346c9193abbaa538678243cd9de7c577348c09e99c7c9" /><meta name="keywords" content="D2e6216bb11716f60e2346c9193abbaa538678243cd9de7c577348c09e99c7c9, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="D2e6216bb11716f60e2346c9193abbaa538678243cd9de7c577348c09e99c7c9" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1994/09/d2e6216bb11716f60e2346c9193abbaa538678243cd9de7c577348c09e99c7c9/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="D2e6216bb11716f60e2346c9193abbaa538678243cd9de7c577348c09e99c7c9"><meta name="twitter:url" content="http://localhost:4000/archive/1994/09/d2e6216bb11716f60e2346c9193abbaa538678243cd9de7c577348c09e99c7c9/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1994-09-30---re-pgp-hole">1994-09-30 - RE: PGP hole</h1><h2 id="header-data">Header Data</h2><p>From: Jonathan Adams &lt;jonathan<span>@</span>memex.com&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: d2e6216bb11716f60e2346c9193abbaa538678243cd9de7c577348c09e99c7c9<br /> Message ID: &lt;199409301410.HAA12750@mailhost.memex.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1994-09-30 14:32:33 UTC<br /> Raw Date: Fri, 30 Sep 94 07:32:33 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Jonathan Adams &lt;jonathan@memex.com&gt;
Date: Fri, 30 Sep 94 07:32:33 PDT
To: cypherpunks@toad.com
Subject: RE: PGP hole
Message-ID: &lt;199409301410.HAA12750@mailhost.memex.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


Alan Barret &lt;barrett@daisy.ee.und.ac.za&gt; wrote to Cypherpunks:
&gt; &gt; 	Yes, this was a deliberate design decision, most probably
&gt; &gt; so the same code could be used to parse --- BEGIN PGP
&gt; &gt; ENCRYPTED MESSAGE --- and --- BEGIN PGP SIGNATURE ---. However,
&gt; &gt; this is a _huge_ security hole, as it allows the nearly-undetectable
&gt; &gt; modification of PGP-signed messages.
&gt; 

&gt; It's nowhere near undetectable.  When you ask pgp to check the
&gt; signature, pgp writes the signed message to a file (or to stdout),
&gt; and that output does not include the {header/junk/extra stuff}
&gt; between the BEGIN line and the blank line.

The problem is, if you are using an interface to PGP, most of the time  
they use PGP in batchmode to check the signature, and they don't let you  
see the output. This means people go "Check the signature", PGP says "Good  
signature found", and they think that it has never been modified. This is  
a security hole. Not everyone uses PGP to do everything from the command  
line. Plus, using lines with only a tab in them, it's possible to add  
seperated paragraphs and "normal-looking" text.

&gt; I don't like this bug/feature, but I don't see it as a serious
&gt; security problem for users who are aware of it.  I do think it
&gt; could be a problem for users who are not aware of it, and who
&gt; incorrectly assume that the "good signature" message means that
&gt; the {header/junk/extra stuff} was part of the signed material.
&gt; 

&gt; --apb (Alan Barrett)

Here's an example:

-----BEGIN PGP SIGNED MESSAGE-----
	
Note that this paragraph was added *AFTER* this message was digitally  
signed.
Note also that the line above this paragraph contains *1* tab. Using this,  
it's possible to add as much stuff to the beginning of a clearsigned  
message as you want, with it looking completely natural, and checking  
fine. This *IS* a security hole.
	
This para was also added later.

Test message

My public key follows, after this signed message:

-----BEGIN PGP SIGNATURE-----
Version: 2.6.1

iQCVAwUBLowcCDidu+MSuAG5AQFpgQP7B1K5uKAQBEdmAxuNGJAvl97GWYlU9miv
HbBQbkPo5C6BsbaJvbzxplZE2YN98bWO2IhMOJdNfywaCuWnQFJGcRcZiGvDqyqc
0vQj0qhy37KPBp1CjrEf76neCjyOL4bWtz+BrF9tru8O7olGv61fGASpkpjL46Zg
bFtb8UP0kV4=
=D3M0
-----END PGP SIGNATURE-----

-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: 2.6.1

mQCVAy5s+KsAAAEEAMp5v1Q/6kqmN3ZFejiBrK1rAgCH0jM/QUHXSbf2wkCCeE4g
Slzp93pIhez6EJasdJFdp/QafO3nTKFjZ9ZZTClnPeMFjlATuJoA/gLsPuoRgRxv
2n9UWkw1eNg8cprfdK/C4oO53Sd4DxrctBHW1enVFMB4TeuLqzidu+MSuAG5AEYg
AAAAAAAAAAO0J0pvbmF0aGFuIFcuIEFkYW1zIDxqb25hZGFtc0BuZXRjb20uY29t
PokAdQMFEC5s+Qw2D9BFC0YeTQEBETAC/1+fw55S1hMBCv5vMOlGlbVSYcaf9QFz
6RnJG4hDXzVPii/PxZf9w5sXraZr39a/OW09sMPdszLlyPfR8zsihd4j4qCnLAjI
v16XKU1ft85DEHjpwQFhWnYNCFSeGX5VU4kAlQMFEC5s+O84nbvjErgBuQEBXRYD
/Ave3Uoc3GRfv/995Yz0RQDUmi4JRzo749dVtXBatODo1vr2209+fHVGu+IZtRx2
WCUKY9YSQr95XJuqxFsfBpdQ6pAyxov5kfecrE2uDrBqlQBCs4IAnMnZeE5FD1Cd
d28qEO2sKAimqJjtcJNvYOr7aL2AFKjXqP1B+wD3Lnn+
=Cqf1
-----END PGP PUBLIC KEY BLOCK-----







</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1994/09">September 1994</a><li><p>Return to “<a href="/authors/jonathan_adams_jonathan_at_memex_com_">Jonathan Adams &lt;jonathan<span>@</span>memex.com&gt;</a>”<li><p>1994-09-30 (Fri, 30 Sep 94 07:32:33 PDT) - RE: PGP hole - <em>Jonathan Adams &lt;jonathan@memex.com&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
