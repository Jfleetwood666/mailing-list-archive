<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/static/img/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/static/img/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title>
    <meta name="author" content="cryptoanarchy.wiki" />
    <meta name="description" content="98e1f64b27462fe288390e31087ccff8fc4aab20556e303804c3f4ad0e1d6d1d" />
    <meta name="keywords" content="98e1f64b27462fe288390e31087ccff8fc4aab20556e303804c3f4ad0e1d6d1d, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
    <meta content="" property="fb:app_id">
    <meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name">

    

    
      <meta content="98e1f64b27462fe288390e31087ccff8fc4aab20556e303804c3f4ad0e1d6d1d" property="og:title">
      <meta content="article" property="og:type">
    

    
      <meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description">
    

    
      <meta content="http://localhost:4000/archive/1994/09/98e1f64b27462fe288390e31087ccff8fc4aab20556e303804c3f4ad0e1d6d1d/" property="og:url">
    

    
      <meta content="2018-06-20T21:43:48+02:00" property="article:published_time">
      <meta content="http://localhost:4000/about/" property="article:author">
    

    
      <meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image">
    

    
      
    

    
      
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@_cryptoanarchy">
    <meta name="twitter:creator" content="@_cryptoanarchy">

    
      <meta name="twitter:title" content="98e1f64b27462fe288390e31087ccff8fc4aab20556e303804c3f4ad0e1d6d1d">
    

    
      <meta name="twitter:url" content="http://localhost:4000/archive/1994/09/98e1f64b27462fe288390e31087ccff8fc4aab20556e303804c3f4ad0e1d6d1d/">
    

    
      <meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!">
    

    

    <!-- Font awesome icons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/static/css/syntax.css">
    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/super-search.css">
    <link rel="stylesheet" href="/static/css/thickbox.css">
    <link rel="stylesheet" href="/static/css/projects.css">
    <link rel="stylesheet" href="/static/css/main.css">

    
  </head>
  <body>
    <div class="container">
      <div class="col-sm-3">
        <div class="fixed-condition">
          <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a>
          <h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1>
          
            <div class="profile-about">
              Arise, you have nothing to lose but your barbed wire fences!
            </div>
          
          <div class="social">
            <ul>
              
                <li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a></li>
              
                <li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a></li>
              
                <li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></li>
              
            </ul>
          </div>
          <hr />
          <ul class="sidebar-nav">
            <strong>Navigation</strong>
            <li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a></li>
            <li><a href="/">Archive Home</a></li>
          </ul>
          <hr>
          <ul class="sidebar-nav">
            <strong>Similar Resources</strong>
            
              <li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a></li>
            
              <li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a></li>
            
              <li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></li>
            
          </ul>
        </div>
        <!-- end /.fixed-condition -->
      </div>
      <div class="col-sm-8 col-offset-1 main-layout">
        <h1 id="1994-09-13---re-alleged-rc4">1994-09-13 - Re: alleged-RC4</h1>

<h2 id="header-data">Header Data</h2>

<p>From: Bill Sommerfeld &lt;sommerfeld@orchard.medford.ma.us&gt;<br />
To: Hal &lt;hfinney@shell.portal.com&gt;<br />
Message Hash: 98e1f64b27462fe288390e31087ccff8fc4aab20556e303804c3f4ad0e1d6d1d<br />
Message ID: &lt;199409131449.KAA00544@orchard.medford.ma.us&gt;<br />
Reply To: &lt;199409130605.XAA24133@jobe.shell.portal.com&gt;<br />
UTC Datetime: 1994-09-13 15:13:32 UTC<br />
Raw Date: Tue, 13 Sep 94 08:13:32 PDT<br /></p>

<h2 id="raw-message">Raw message</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Bill Sommerfeld &lt;sommerfeld@orchard.medford.ma.us&gt;
Date: Tue, 13 Sep 94 08:13:32 PDT
To: Hal &lt;hfinney@shell.portal.com&gt;
Subject: Re: alleged-RC4
In-Reply-To: &lt;199409130605.XAA24133@jobe.shell.portal.com&gt;
Message-ID: &lt;199409131449.KAA00544@orchard.medford.ma.us&gt;
MIME-Version: 1.0
Content-Type: text/plain


Since I haven't seen a statement by anyone who I would believe that
this is, in fact, RC4, I'm calling it "Alleged-RC4"..

Actually, all the %256 operations in the code are superfluous on
8-bit-byte platforms since the indices are declared as `unsigned
char'.

There are two interesting features in this alleged-RC4 which clearly
put it above the typical xor-based homebrew cypher..

 1) the "pad" is maintained as a permutation of 0..255, so the output
should always have a close-to-uniform distribution of output values.

 2) the operations which stir the "pad" all have two counters: one (x)
which increments by 1 each time, and one (t) which moves in a way
dependant on the "pad" values.  The x counter guarantees that all
bytes in the pad get shuffled with roughly equal frequency, so you're
less likely to get stuck in a shorter-length cycle.  The y counter
moves in a "chaotic" data-dependant way, and each slot in the pad
affects its stepping in turn.

Probably the only potential weakness I can see is that the `x' and `y'
counters are always initialized to zero when starting off; this means
that an attacker can almost always know the `x' value used to encrypt
each byte of cyphertext they find.  I can't see any way to exploit
this, though.  It would seem that you could (slightly) strengthen the
cipher by starting with x=state[0] and y=state[1], then cranking the
key generation loop for two more iterations..

The fact that the NSA allows export of this cipher (albeit with keys
limited to 40 bits) is interesting.. unlike DES, the alleged-RC4's key
setup does not appear to be particularly parallelizeable.  A
fully-pipelined alleged-RC4 key breaker would require 256 stages of
key setup followed by n stages of "encryption" (with ~2k bits of state
per stage).  This is significantly more complex than the 16-stage
pipeline with ~128 bits of state per stage in the pipelined
DES-breaker.

					- Bill





</code></pre></div></div>

<h2 id="thread">Thread</h2>

<ul>
  <li>
    <p>Return to <a href="/archive/1994/09">September 1994</a></p>
  </li>
  <li>
    <p>1994-09-13 (Mon, 12 Sep 94 21:18:26 PDT) - <a href="/archive/1994/09/9724b423660476f7e42052da13ae317ed62215da9b38cd19f9d7cacd531d8289">RC4</a> - <em>schneier@chinet.chinet.com (Bruce Schneier)</em></p>
    <ul>
      <li>1994-09-13 (Mon, 12 Sep 94 23:05:45 PDT) - <a href="/archive/1994/09/86c1f2c8746d495232e0bac45195b8040aca69f4bf9483e81320c9f6969655fe">Re: RC4</a> - <em>Hal &lt;hfinney@shell.portal.com&gt;</em>
        <ul>
          <li>1994-09-13 (Tue, 13 Sep 94 08:13:32 PDT) - Re: alleged-RC4 - <em>Bill Sommerfeld &lt;sommerfeld@orchard.medford.ma.us&gt;</em>
            <ul>
              <li>1994-09-14 (Tue, 13 Sep 94 21:02:52 PDT) - <a href="/archive/1994/09/6569d3e2b3a2080d5cdbe5b2a8a0f1e9023fb459037a5cf2f88121ebef7178f4">Re: alleged-RC4</a> - <em>Hal &lt;hfinney@shell.portal.com&gt;</em>
                <ul>
                  <li>1994-09-14 (Wed, 14 Sep 94 08:36:57 PDT) - <a href="/archive/1994/09/d0f8fb7b2adc73244ae7b02894c86ed17f67d8a4b6597c369cf11ede38f868c0">Re: alleged-RC4</a> - <em>Bill Sommerfeld &lt;sommerfeld@orchard.medford.ma.us&gt;</em></li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
</ul>


        <footer>
          
            - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a>
          
        </footer>
      </div>
      <!-- end /.col-sm-8 -->
    </div>
    <!-- end /.container -->

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/super-search.js"></script>
    <script src="/static/js/thickbox-compressed.js"></script>
    <script src="/static/js/projects.js"></script>
  </body>
</html>

