<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="D49b021b1ae0282f98d2440b58852df3c8101342f959e90394d2377babefebd7" /><meta name="keywords" content="D49b021b1ae0282f98d2440b58852df3c8101342f959e90394d2377babefebd7, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="D49b021b1ae0282f98d2440b58852df3c8101342f959e90394d2377babefebd7" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1994/09/d49b021b1ae0282f98d2440b58852df3c8101342f959e90394d2377babefebd7/" property="og:url"><meta content="2018-06-23T00:09:03+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="D49b021b1ae0282f98d2440b58852df3c8101342f959e90394d2377babefebd7"><meta name="twitter:url" content="http://localhost:4000/archive/1994/09/d49b021b1ae0282f98d2440b58852df3c8101342f959e90394d2377babefebd7/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1994-09-23---math-brands-cash-hals-post-2">1994-09-23 - MATH: Brands’ cash, Hal’s post #2</h1><h2 id="header-data">Header Data</h2><p>From: Karl Lui Barrus &lt;klbarrus@owlnet.rice.edu&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: d49b021b1ae0282f98d2440b58852df3c8101342f959e90394d2377babefebd7<br /> Message ID: &lt;9409230054.AA24515@snowy.owlnet.rice.edu&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1994-09-23 00:54:28 UTC<br /> Raw Date: Thu, 22 Sep 94 17:54:28 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Karl Lui Barrus &lt;klbarrus@owlnet.rice.edu&gt;
Date: Thu, 22 Sep 94 17:54:28 PDT
To: cypherpunks@toad.com
Subject: MATH: Brands' cash, Hal's post #2
Message-ID: &lt;9409230054.AA24515@snowy.owlnet.rice.edu&gt;
MIME-Version: 1.0
Content-Type: text/plain


-----BEGIN PGP SIGNED MESSAGE-----

This post gives numerical examples to go along with Hal Finney's excellent
description of Brands' digital cash, posted earlier.  If the math is too
much, just remember the whole point:

&gt; Blind signatures are, IMO, the key to anonymous digital cash, and in fact
&gt; to many forms of anonymity.  The ability to engage in mutual information
&gt; manipulation with another person, while guaranteeing that no linkage will
&gt; later be possible between the data exchanged and the results of that
&gt; calculation, is the foundation for interacting in a complex way without
&gt; losing any privacy...
&gt; Vicki wants to end up with a non-interactive signature on m', which is a 
&gt; special transformation of m.  To do this, she engages in an interactive 
&gt; signature protocol with Paul, getting him to sign m... the result is
&gt; that she ends up with a non-interactive signature on m' because Paul was
&gt; willing to participate in an interactive signature session on m

Continuing along:

&gt; Now for the mathematics.  Recall the g is the "generator" of the group,
&gt; the base of all of the powers.  x is Paul's secret key, and GX=g^x is his
&gt; public key.  

I will use g = 10, n = 17389 as in the previous example.  Paul will choose 
x = 351 to be his secret key, so GX = 10^351 mod 17389 = 16987 is his public 
key.  In addition, the message is m = 1994.

&gt; As the first step of the interactive protocol, Paul chooses a random w
&gt; and sends Vicki MX = m^x, GW = g^w, and MW = m^w.

Paul chooses a random w = 666

MX = 1994^351 mod 17389 = 11740
GW = 10^666 mod 17389 = 7115
MW = 1994^666 mod 17389 = 13262

&gt; The relationship between m', which is what Vicki will end up
&gt; with a signature on, and m, which is the number that Paul sees, is
&gt;       m' = (m^s)*(g^t).

Vicki chooses s = 3694, t = 1243

m' = (1994^3694)*(10^1243) mod 17389 = 10313

&gt; the challenge c is calculated as the hash of (m,MX,GW,MW).  Vicki
&gt; must transform these numbers so that Paul will not recognize them, but in
&gt; such a way that the mathematical relationships are maintained.
&gt; To do this, Vicki chooses two (more) random numbers, u and v (along with
&gt; s and t above).

Vicki chooses u = 5192, v = 100

&gt;   MX' = m'^x = ((m^s)*(g^t))^x = (m^(s*x))*(g^(t*x)) = (MX^s)*(GX^t)
&gt;   GW' = g^w' = g^(u*w+v) = (g^(u*w))*(g^v) = (GW^u)*(g^v)
&gt;   MW' = m'^w' = ((m^s)*(g^t))^(u*w+v) = [...] =
&gt;                                       (GW^(u*t))*(MW^(u*s))*(m'^v)

MX' = (MX^s)*(GX^t) = (11740^3694)*(16987^1243) mod 17389 = 10710
GW' = (GW^u)*(g^v) = (7115^5192)*(10^100) mod 17389 = 12113
MW' = (7115^(5192 1243))*(11740^(5192 3694))*(10313^100) mod 17389 = 9314

&gt; Using these, Vicki calculates her hash c'= Hash(m',MX',GW',MW').

c' = hash(10313,10710,12113,9314) = 7672 (some hash function I made up)

&gt; Now, the c she sends to Paul...
&gt; c = c'/u 

c = (7672/5192) mod 17389 = 323

[     5192 c = 7672 mod 17389  
  --&gt; 5192 c" = 1 mod 17389 
  --&gt; c" = 3520
		 ==&gt; c = c" 7672 mod 17389 = 323

  check: (323 5192) mod 17389 = 7672
]

&gt; Paul will ... calculate r = c*x+w.

r = (323 351 + 666) mod 17388 = 9711

&gt; [Vicki calculates] r' = u*r + v

r' = (5192 9711 + 100) mod 17388 = 11800

&gt; The resulting signature on m' is (MX',GW',MW',r')

So the resulting signature is (10710,12113,9314,11800)

Okay, that should be an actual example of the protocol, unless I messed 
up somewhere ;)  I hope to finish going through Hal's third post soon.

Karl Barrus
klbarrus@owlnet.rice.edu


-----BEGIN PGP SIGNATURE-----
Version: 2.6.1

iQCVAwUBLoImUMSF/V8IjI8hAQGRmAP/RojMlpm8rnnx4K6c3GEHsBoQL7hIhdBB
bTiwBhkXbi8ZhHsZJtX9mFceIhTK7yIxVsq9y17d2m5NghGME1qtIN+MjbbvwHfp
j9S9fWwF6/mIiRvV9IM1a23IGhyZi0ZQASLKRiPlStjbcwv6QoGxZQuTyGOD8pSn
hpoKosUFbqY=
=EIjf
-----END PGP SIGNATURE-----





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1994/09">September 1994</a><li><p>1994-09-23 (Thu, 22 Sep 94 17:54:28 PDT) - MATH: Brands’ cash, Hal’s post #2 - <em>Karl Lui Barrus &lt;klbarrus@owlnet.rice.edu&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
