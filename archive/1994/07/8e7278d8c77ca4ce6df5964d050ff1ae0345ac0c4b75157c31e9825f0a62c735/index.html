<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="8e7278d8c77ca4ce6df5964d050ff1ae0345ac0c4b75157c31e9825f0a62c735" /><meta name="keywords" content="8e7278d8c77ca4ce6df5964d050ff1ae0345ac0c4b75157c31e9825f0a62c735, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="8e7278d8c77ca4ce6df5964d050ff1ae0345ac0c4b75157c31e9825f0a62c735" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1994/07/8e7278d8c77ca4ce6df5964d050ff1ae0345ac0c4b75157c31e9825f0a62c735/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="8e7278d8c77ca4ce6df5964d050ff1ae0345ac0c4b75157c31e9825f0a62c735"><meta name="twitter:url" content="http://localhost:4000/archive/1994/07/8e7278d8c77ca4ce6df5964d050ff1ae0345ac0c4b75157c31e9825f0a62c735/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1994-07-10---re-bit-counting">1994-07-10 - Re: Bit counting</h1><h2 id="header-data">Header Data</h2><p>From: rarachel<span>@</span>prism.poly.edu (Arsen Ray Arachelian)<br /> To: ifarqhar@laurel.ocs.mq.edu.au (Ian Farquhar)<br /> Message Hash: 8e7278d8c77ca4ce6df5964d050ff1ae0345ac0c4b75157c31e9825f0a62c735<br /> Message ID: &lt;9407100636.AA21021@prism.poly.edu&gt;<br /> Reply To: &lt;199407070257.AA00900@laurel.ocs.mq.edu.au&gt;<br /> UTC Datetime: 1994-07-10 06:48:34 UTC<br /> Raw Date: Sat, 9 Jul 94 23:48:34 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: rarachel@prism.poly.edu (Arsen Ray Arachelian)
Date: Sat, 9 Jul 94 23:48:34 PDT
To: ifarqhar@laurel.ocs.mq.edu.au (Ian Farquhar)
Subject: Re: Bit counting
In-Reply-To: &lt;199407070257.AA00900@laurel.ocs.mq.edu.au&gt;
Message-ID: &lt;9407100636.AA21021@prism.poly.edu&gt;
MIME-Version: 1.0
Content-Type: text


&gt; 
&gt; &gt;Why bother when you can simply do an eight line function?
&gt; 
&gt; &gt;int bitcount(char b)
&gt; &gt;{
&gt; &gt;register int retval=0;
&gt; 
&gt; &gt; if (a &amp; 1) retval++;
&gt; &gt; if (a &amp; 2) retval++;
&gt; [...]
&gt; 
&gt; Because on a lot of architectures this implementation may be hideously
&gt; inefficient.  All the world is not an Intel chip, thank god.

Okay, I'll bite this one again.

6502:
LDX #$00
LDA b
BIT #$01
BEQ +2
INX
BIT #$02
BEQ +2
INX
/\/\/\/\//\
TXA
STA returnvalue
RTS

There.  On a 6502, this too would take about 5 bytes per test * 8 tests, that's
40 bytes.  So that's about 60 bytes or so maximum for this function.  Now for
68000:

MOVE.B 0,D1
LEA A0,[address_of_parameter_b_from_stack]
MOVE.B [A0],D0
MOVE.B D0,D2
ANDI #01,D0
BEQ [skip three instructions]
ADDI #1,D1
MOVE.B D2,D0
ANDI #02,D0 
BEQ [skip three instructions]
/\/\/\/\/\/
MOV D1,[return_value_on_stack]
RET

Same commands, but on the 68K, it'll take up a bit more space, though the 68K
will run faster.

Now granted on certain machines the XOR method is faster, but is it more
obvious?  I've seen lots of "cool" code in my time.  The verdict on it is
that while it's neato whiz bang cool, it's hard to debug or update if it
needs fixing, and tends to be very non obvious.  If you use a good compiler
which has register optimization, the function done the long way will be
as fast as the XOR method, and cleaner, and in some cases actually faster.






</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1994/07">July 1994</a><li>Return to “<a href="/author/ian_farquhar_ifarqhar_at_laurel_ocs_mq_edu_au_">Ian Farquhar &lt;ifarqhar<span>@</span>laurel.ocs.mq.edu.au&gt;</a>”<li>Return to “<a href="/author/rarachel_at_prism_poly_edu_arsen_ray_arachelian_">rarachel<span>@</span>prism.poly.edu (Arsen Ray Arachelian)</a>”<li><p>Return to “<a href="/author/tim_werner_werner_at_mc_ab_com_">tim werner &lt;werner<span>@</span>mc.ab.com&gt;</a>”<li>1994-07-07 (Wed, 6 Jul 94 19:58:27 PDT) - <a href="/archive/1994/07/1d7314d1fe69719702cb22aa2ae19b81662c71b4783d84df622e8a4c64309ac8">Bit counting</a> - <em>Ian Farquhar &lt;ifarqhar@laurel.ocs.mq.edu.au&gt;</em><ul><li>1994-07-07 (Thu, 7 Jul 94 04:53:19 PDT) - <a href="/archive/1994/07/a896bbc7082ea6e9da7c54dd1148367f147fb4db79f047440f223179fe252a08">Re: Bit counting</a> - <em>tim werner &lt;werner@mc.ab.com&gt;</em><li>1994-07-10 (Sat, 9 Jul 94 23:48:34 PDT) - Re: Bit counting - <em>rarachel@prism.poly.edu (Arsen Ray Arachelian)</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
