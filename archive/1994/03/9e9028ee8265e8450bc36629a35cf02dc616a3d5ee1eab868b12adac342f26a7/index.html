<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="9e9028ee8265e8450bc36629a35cf02dc616a3d5ee1eab868b12adac342f26a7" /><meta name="keywords" content="9e9028ee8265e8450bc36629a35cf02dc616a3d5ee1eab868b12adac342f26a7, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="9e9028ee8265e8450bc36629a35cf02dc616a3d5ee1eab868b12adac342f26a7" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1994/03/9e9028ee8265e8450bc36629a35cf02dc616a3d5ee1eab868b12adac342f26a7/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="9e9028ee8265e8450bc36629a35cf02dc616a3d5ee1eab868b12adac342f26a7"><meta name="twitter:url" content="http://localhost:4000/archive/1994/03/9e9028ee8265e8450bc36629a35cf02dc616a3d5ee1eab868b12adac342f26a7/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1994-03-06---re-stealth-pgp">1994-03-06 - Re: Stealth PGP</h1><h2 id="header-data">Header Data</h2><p>From: Matthew J Ghio &lt;mg5n+<span>@</span>andrew.cmu.edu&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: 9e9028ee8265e8450bc36629a35cf02dc616a3d5ee1eab868b12adac342f26a7<br /> Message ID: &lt;MhSWI=m00awH0EYEcH@andrew.cmu.edu&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1994-03-06 18:48:27 UTC<br /> Raw Date: Sun, 6 Mar 94 10:48:27 PST<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Matthew J Ghio &lt;mg5n+@andrew.cmu.edu&gt;
Date: Sun, 6 Mar 94 10:48:27 PST
To: cypherpunks@toad.com
Subject: Re: Stealth PGP
Message-ID: &lt;MhSWI=m00awH0EYEcH@andrew.cmu.edu&gt;
MIME-Version: 1.0
Content-Type: text/plain


There are actually several clever ways that you can get around the
problem with the RSA encrypted data being less than the modulus.  The
simplest is to encrypt it more than once.
Suppose you have a modulus m of legnth n.  You then create a block of
data to encrypt, b, of legnth n. If b is less than m, encrypt it with
RSA.  If not, don't encrypt it.  Then take 2^n-b-1 (which, btw, is the
same as xoring b with all one-bits).  If that result is less than m,
encrypt it with RSA.  Since m is greater than half of 2^n (it must be,
otherwise it would be less than legnth n), all possible plaintexts will
be encrypted at least once with RSA, some twice.  This does leave a
somewhat uneven distribution of values when comparing plaintext and
ciphertext (which can be minimized by more encryptions), but that only
shows up when and if the message is decrypted; as long as you use random
padding properly before encrypting, the encrypted data will look
completely random.

My ideal "Stealth-PGP" would work something like this: Take a file,
encrypt it with a random session key, prepend the session key to the
file, encrypt the first n bytes (which include the session key and part
of the encrypted data) with RSA if it's less than m, XOR it (reverse all
bits), and then encrypt with RSA if that's less than m.

Actually, putting the data inside the RSA might not be a good idea, it
would not work well for small files unless you added a legnth byte. 
Maybe the RSA part could just be filled with random padding...





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1994/03">March 1994</a><li><p>Return to “<a href="/authors/matthew_j_ghio_mg5n_at_andrew_cmu_edu_">Matthew J Ghio &lt;mg5n+<span>@</span>andrew.cmu.edu&gt;</a>”<li><p>1994-03-06 (Sun, 6 Mar 94 10:48:27 PST) - Re: Stealth PGP - <em>Matthew J Ghio &lt;mg5n+@andrew.cmu.edu&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
