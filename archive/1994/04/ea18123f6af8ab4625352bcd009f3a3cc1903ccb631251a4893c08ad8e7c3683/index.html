<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/static/img/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/static/img/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title>
    <meta name="author" content="cryptoanarchy.wiki" />
    <meta name="description" content="Ea18123f6af8ab4625352bcd009f3a3cc1903ccb631251a4893c08ad8e7c3683" />
    <meta name="keywords" content="Ea18123f6af8ab4625352bcd009f3a3cc1903ccb631251a4893c08ad8e7c3683, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
    <meta content="" property="fb:app_id">
    <meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name">

    

    
      <meta content="Ea18123f6af8ab4625352bcd009f3a3cc1903ccb631251a4893c08ad8e7c3683" property="og:title">
      <meta content="article" property="og:type">
    

    
      <meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description">
    

    
      <meta content="http://localhost:4000/archive/1994/04/ea18123f6af8ab4625352bcd009f3a3cc1903ccb631251a4893c08ad8e7c3683/" property="og:url">
    

    
      <meta content="2018-06-20T21:43:48+02:00" property="article:published_time">
      <meta content="http://localhost:4000/about/" property="article:author">
    

    
      <meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image">
    

    
      
    

    
      
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@_cryptoanarchy">
    <meta name="twitter:creator" content="@_cryptoanarchy">

    
      <meta name="twitter:title" content="Ea18123f6af8ab4625352bcd009f3a3cc1903ccb631251a4893c08ad8e7c3683">
    

    
      <meta name="twitter:url" content="http://localhost:4000/archive/1994/04/ea18123f6af8ab4625352bcd009f3a3cc1903ccb631251a4893c08ad8e7c3683/">
    

    
      <meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!">
    

    

    <!-- Font awesome icons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/static/css/syntax.css">
    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/super-search.css">
    <link rel="stylesheet" href="/static/css/thickbox.css">
    <link rel="stylesheet" href="/static/css/projects.css">
    <link rel="stylesheet" href="/static/css/main.css">

    
  </head>
  <body>
    <div class="container">
      <div class="col-sm-3">
        <div class="fixed-condition">
          <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a>
          <h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1>
          
            <div class="profile-about">
              Arise, you have nothing to lose but your barbed wire fences!
            </div>
          
          <div class="social">
            <ul>
              
                <li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a></li>
              
                <li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a></li>
              
                <li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></li>
              
            </ul>
          </div>
          <hr />
          <ul class="sidebar-nav">
            <strong>Navigation</strong>
            <li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a></li>
            <li><a href="/">Archive Home</a></li>
          </ul>
          <hr>
          <ul class="sidebar-nav">
            <strong>Similar Resources</strong>
            
              <li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a></li>
            
              <li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a></li>
            
              <li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></li>
            
          </ul>
        </div>
        <!-- end /.fixed-condition -->
      </div>
      <div class="col-sm-8 col-offset-1 main-layout">
        <h1 id="1994-04-15---re-remailer-reply-blocks">1994-04-15 - Re: Remailer Reply Blocks</h1>

<h2 id="header-data">Header Data</h2>

<p>From: Graham Toal &lt;gtoal@an-teallach.com&gt;<br />
To: cypherpunks@toad.com<br />
Message Hash: ea18123f6af8ab4625352bcd009f3a3cc1903ccb631251a4893c08ad8e7c3683<br />
Message ID: &lt;199404150227.DAA28644@an-teallach.com&gt;<br />
Reply To: <em>N/A</em><br />
UTC Datetime: 1994-04-15 02:28:58 UTC<br />
Raw Date: Thu, 14 Apr 94 19:28:58 PDT<br /></p>

<h2 id="raw-message">Raw message</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Graham Toal &lt;gtoal@an-teallach.com&gt;
Date: Thu, 14 Apr 94 19:28:58 PDT
To: cypherpunks@toad.com
Subject: Re: Remailer Reply Blocks
Message-ID: &lt;199404150227.DAA28644@an-teallach.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


From: Matthew J Ghio &lt;mg5n+@andrew.cmu.edu&gt;

: Which is why my remailer uses 3DES and adds random padding to the
: address before encrypting it.  Random padding will thwart many chosen
: plaintext attacks, especially if you do some transpositions prior to
: encrypting it.  Since the text to encrypt is so small, doing five or ten
: consecutive DES encryptions with different keys would not use up much
: CPU time, but could dramatically increase security.  Also I compress the
: address slightly by stripping off the high bits so that 8 bytes fit into
: 7.  Just a few suggestions to keep in mind...

You beat me to it :-)  I was going to suggest xoring the data with a set
of random numbers (generated along with the des key) to shield it from
known plaintext, but a few rounds of DES might do just as well.  You have
to do *something* because there's a known-plaintext '@' in every email addr.

: Overall, looks pretty good.  BTW, what's the number that it prepends to
: your email address when you get a reply?

The things I'd improve on it are the need to edit out the indentation
when you use the header block in a reply, and that you have to move the
block from the end of the file to the top.  Either it should start
out at the top, or the remailer should search the whole mail for it.

On chaining reply blocks:  I was wrong about them getting larger and
larger as they went through remailers - you don't have to encode the
ascii representation of the last remailer's block and then ascii
encode that too - you could generate your block by first de-ascii'ing
the last block, prepending the return address, and then re-ascii'ing it.
That way the previous return addresses would contribute the same size
of data in every link in the chain.

One thing more has to be done to foil traffic analysis - the encrypted
email address has to be padded out a lot so that they can't guess who
it was by knowing the lengths of the email addresses of a small set
of possible posters.  Assuming we're already stripping out the personal
names etc in email addreses and just keeping the canonical bits (for
example "Graham Toal" &lt;gtoal@gtoal.com&gt;  -&gt;   gtoal@gtoal.com
then I'd suggest padding with spaces to something like 64 chars, then
going up +64 each time for those X400 idiots who might want to post
through us :-)  That way you won't be able to tell a 128-byte long name
from 2 hops of a 64-byte short name.

G





</code></pre></div></div>

<h2 id="thread">Thread</h2>

<ul>
  <li>
    <p>Return to <a href="/archive/1994/04">April 1994</a></p>
  </li>
  <li>
    <p>1994-04-15 (Thu, 14 Apr 94 19:28:58 PDT) - Re: Remailer Reply Blocks - <em>Graham Toal &lt;gtoal@an-teallach.com&gt;</em></p>
    <ul>
      <li>1994-04-15 (Fri, 15 Apr 94 00:13:51 PDT) - <a href="/archive/1994/04/de32abc73df4a6f695293c646907339b86b4320f32710e6b611d93420b5147f5">Re: Remailer Reply Blocks</a> - <em>Matthew J Ghio &lt;mg5n+@andrew.cmu.edu&gt;</em></li>
    </ul>
  </li>
</ul>


        <footer>
          
            - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a>
          
        </footer>
      </div>
      <!-- end /.col-sm-8 -->
    </div>
    <!-- end /.container -->

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/super-search.js"></script>
    <script src="/static/js/thickbox-compressed.js"></script>
    <script src="/static/js/projects.js"></script>
  </body>
</html>

