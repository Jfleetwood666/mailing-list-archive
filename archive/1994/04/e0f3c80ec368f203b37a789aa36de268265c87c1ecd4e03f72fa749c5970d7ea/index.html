<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="E0f3c80ec368f203b37a789aa36de268265c87c1ecd4e03f72fa749c5970d7ea" /><meta name="keywords" content="E0f3c80ec368f203b37a789aa36de268265c87c1ecd4e03f72fa749c5970d7ea, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="E0f3c80ec368f203b37a789aa36de268265c87c1ecd4e03f72fa749c5970d7ea" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1994/04/e0f3c80ec368f203b37a789aa36de268265c87c1ecd4e03f72fa749c5970d7ea/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="E0f3c80ec368f203b37a789aa36de268265c87c1ecd4e03f72fa749c5970d7ea"><meta name="twitter:url" content="http://localhost:4000/archive/1994/04/e0f3c80ec368f203b37a789aa36de268265c87c1ecd4e03f72fa749c5970d7ea/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1994-04-24---clipper-leaf-holes">1994-04-24 - Clipper LEAF Holes?</h1><h2 id="header-data">Header Data</h2><p>From: Mike Ingle &lt;MIKEINGLE<span>@</span>delphi.com&gt;<br /> To: cypherpunks@toad.com<br /> Message Hash: e0f3c80ec368f203b37a789aa36de268265c87c1ecd4e03f72fa749c5970d7ea<br /> Message ID: &lt;01HBJGK3864I9TDZ96@delphi.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1994-04-24 08:24:42 UTC<br /> Raw Date: Sun, 24 Apr 94 01:24:42 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Mike Ingle &lt;MIKEINGLE@delphi.com&gt;
Date: Sun, 24 Apr 94 01:24:42 PDT
To: cypherpunks@toad.com
Subject: Clipper LEAF Holes?
Message-ID: &lt;01HBJGK3864I9TDZ96@delphi.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


As I understand the Clipper/Capstone LEAF, it works like this:

Take 80-bit session key. Encrypt with device-unique key. Add 32-bit
serial number and 16-bit checksum. Encrypt resulting 128-bit packet
with family key.

One of the EES chips, the type designed for cellular and other phones,
operates in "1-bit CFB mode". This would seem to indicate that it is a
straight-thru device - that the data input and output rates are the same.
So the LEAF is only sent once; it is not repeated throughout the output.

The user is forced to send a valid LEAF because the receiving chip will
not set up without receiving a LEAF. But how does the receiving chip check
to see if the LEAF is valid? The obvious way is to decrypt it with the
family key, and then verify the checksum. But EES chips for different
countries will have different family keys. So if an American EES chip
sends a LEAF to a foreign one, how does the foreign one verify the LEAF?

Even if the receiver can decrypt the first level of the LEAF and examine
the checksum, it doesn't have your device-unique key, so it cannot check
to see if the session key in the LEAF is the same session key that you
sent to it. So it would seem that any valid LEAF would work, even if it
is not the one for the current session key.

Am I missing something in the Clipper design which prevents this?

--- Mike
   





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1994/04">April 1994</a><li><p>Return to “<a href="/author/mike_ingle_mikeingle_at_delphi_com_">Mike Ingle &lt;MIKEINGLE<span>@</span>delphi.com&gt;</a>”<li><p>1994-04-24 (Sun, 24 Apr 94 01:24:42 PDT) - Clipper LEAF Holes? - <em>Mike Ingle &lt;MIKEINGLE@delphi.com&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
