<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="86271023cf25d72089aa99fdfc2d499a7a23c3b3994974bbb5b10ef28ef6bfa6" /><meta name="keywords" content="86271023cf25d72089aa99fdfc2d499a7a23c3b3994974bbb5b10ef28ef6bfa6, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="86271023cf25d72089aa99fdfc2d499a7a23c3b3994974bbb5b10ef28ef6bfa6" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1994/12/86271023cf25d72089aa99fdfc2d499a7a23c3b3994974bbb5b10ef28ef6bfa6/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="86271023cf25d72089aa99fdfc2d499a7a23c3b3994974bbb5b10ef28ef6bfa6"><meta name="twitter:url" content="http://localhost:4000/archive/1994/12/86271023cf25d72089aa99fdfc2d499a7a23c3b3994974bbb5b10ef28ef6bfa6/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1994-12-20---re-hiding-strings-in-binaries">1994-12-20 - Re: hiding strings in binaries</h1><h2 id="header-data">Header Data</h2><p>From: elton<span>@</span>sybase.com (Elton Wildermuth)<br /> To: cypherpunks@toad.com<br /> Message Hash: 86271023cf25d72089aa99fdfc2d499a7a23c3b3994974bbb5b10ef28ef6bfa6<br /> Message ID: &lt;9412200231.AA04630@fnord.sybgate.sybase.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1994-12-20 02:30:42 UTC<br /> Raw Date: Mon, 19 Dec 94 18:30:42 PST<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: elton@sybase.com (Elton Wildermuth)
Date: Mon, 19 Dec 94 18:30:42 PST
To: cypherpunks@toad.com
Subject: Re: hiding strings in binaries
Message-ID: &lt;9412200231.AA04630@fnord.sybgate.sybase.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


&gt;I didn't write this program and I don't know how it works.  It was posted 
&gt;on the nyx freenet by kstern@nyx.cs.du.edu.  When you compile and run it, 
&gt;it prints out the lyrics to "The Twelve Days of Christmas".

I didn't write it either, but a friend asked how the hell it did
that, so I hacked on it for a couple hours and now I _do_ know how
it works:  it's a substitution cipher just like rot-13, coupled
with a selector to print phrases in a predetermined order.

This string:

&gt;"!ek;dc i@bK'(q)-[w]*%n+r3#l,{}:\nuwloca-O;m .vpbks,fxntdCeghiry"

contains the substitution cipher.  All the letters of the song are
in the 2nd half of the string, starting at '\n'.  The substitutions
are the first half of the string.  The program searches for a match
in the index section; when it finds a match, it adds a constant to
that character's array index to get the index of the character to
print.  Thus, searching for '!' causes '\n' to print; searching for
'e' gets 'u'.

This string:

&gt;"@n'+,#'/*{}w+/w#cdnr/+,{}r/*de}+,/*{*+,/w{%+,/w#q#n+,/#{l,+,/n{n+,/+#n+,/#\
&gt;;#q#n+,/+k#;*+,/'r :'d*'3,}{w+K w'K:'+}e#';dq#'l \
&gt;q#'+d'K#!/+k#;q#'r}eKK#}w'r}eKK{nl]'/#;#q#n'){)#}w'){){nl]'/+#n';d}rw' i;# \
&gt;){nl]!/n{n#'; r{#w'r nc{nl]'/#{l,+'K {rw' iK{;[{nl]'/w#q#n'wk nw' \
&gt;iwk{KK{nl]!/w{%'l##w#' i; :{nl]'/*{q#'ld;r#n'}{nlwb!/*de}'c \
&gt;;;{nl'-{}rw]'/+,}##'*}#nc,',#nw]'/+kd'+e}+;#'rdq#w! nr'/ ') }+}{rl#'{n' ')# \
&gt;}'+}##(!!/"

is the phrases of the song.  Each '/' character is the end of a phrase:
"@n'+,#'" == "On the "; "*{}w+" == "first"; "w#cdnr" == "second"; etc.

The rest of the program is a selector to choose which phrase to print next.
It doesn't run everywhere (it presumes its character set is 7-bit ASCII),
and it depends on being invoked with no arguments.  (Try it with one or two
arguments -- see what happens!  It redefines the standard main() argument
'argv' as an integer purely so that it can be 100% recursive, and depends
on 'argc' being zero in the outermost level.)

It's one busy s.o.b., too, because _every_ increment of the lookup index
is a separate function call, as is the phrase selector and character
printer.

I gather that this was one of the entries in the "obfuscated 'C'"
programming contests that used to be held some years ago.  (Are they
still held?)

			-- Elton




</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1994/12">December 1994</a><li>Return to “<a href="/authors/elton_at_sybase_com_elton_wildermuth_">elton<span>@</span>sybase.com (Elton Wildermuth)</a>”<li><p>Return to “<a href="/authors/fain_at_tyto_etho_caltech_edu_dan_fain_">fain<span>@</span>tyto.etho.caltech.edu (Dan Fain)</a>”<li>1994-12-20 (Mon, 19 Dec 94 18:30:42 PST) - Re: hiding strings in binaries - <em>elton@sybase.com (Elton Wildermuth)</em><ul><li>1994-12-20 (Mon, 19 Dec 94 21:55:00 PST) - <a href="/archive/1994/12/9205be6ab9b12439e794b9dc9041180d28eecdda7767c360b094a7d77a70b03d">Re: hiding strings in binaries</a> - <em>fain@tyto.etho.caltech.edu (Dan Fain)</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
