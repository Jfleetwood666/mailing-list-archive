<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="Eb3482166950e49b9f3aa5b2b22f0f7d9aa132ed12db0347f767d245b947b1af" /><meta name="keywords" content="Eb3482166950e49b9f3aa5b2b22f0f7d9aa132ed12db0347f767d245b947b1af, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="Eb3482166950e49b9f3aa5b2b22f0f7d9aa132ed12db0347f767d245b947b1af" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1993/01/eb3482166950e49b9f3aa5b2b22f0f7d9aa132ed12db0347f767d245b947b1af/" property="og:url"><meta content="2018-06-21T22:53:40+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="Eb3482166950e49b9f3aa5b2b22f0f7d9aa132ed12db0347f767d245b947b1af"><meta name="twitter:url" content="http://localhost:4000/archive/1993/01/eb3482166950e49b9f3aa5b2b22f0f7d9aa132ed12db0347f767d245b947b1af/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1993-01-14---details-on-return-envelopes">1993-01-14 - Details on return envelopes</h1><h2 id="header-data">Header Data</h2><p>From: eric@parallax.com (Eric Messick)<br /> To: cypherpunks@toad.com<br /> Message Hash: eb3482166950e49b9f3aa5b2b22f0f7d9aa132ed12db0347f767d245b947b1af<br /> Message ID: &lt;9301140202.AA22884@parallax.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1993-01-14 02:07:53 UTC<br /> Raw Date: Wed, 13 Jan 93 18:07:53 PST<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: eric@parallax.com (Eric Messick)
Date: Wed, 13 Jan 93 18:07:53 PST
To: cypherpunks@toad.com
Subject: Details on return envelopes
Message-ID: &lt;9301140202.AA22884@parallax.com&gt;
MIME-Version: 1.0
Content-Type: text/plain



This is a long, complicated, and information dense message.  You've
been warned.

I've been working out details of what would be required of an
anonymous return envelope.  To make sure I've thought of everything,
I've filled in a matrix with the types of information that might need
to be passed between the various participants during the sending of a
message.  The person who created the envelope is the ultimate
recipient of the message (recv).  The envelope has somehow been
transmitted to a person (send) who wishes to send a message to recv.
The message will be transmitted via several remailers, collectively
referred to as hops.  This results in nine potential transmission
channels, several of which need not be possible for various reasons.
Clearly, the sender does not need a special channel to communicate
back to herself, and likewise the receiver does not need special
provisions to communicate to herself either.  The sender should be
unable to receive information from the various hops, as that would
compromise the path that the message takes.  The various hops already
communicate directly with their following neighbor through headers,
and we want to prohibit communication back towards the sender.  The
remaining five cases are listed below:

	     |		from
	     |	send	recv	hops
-------------+------------------------
	send |	-	pneed	(ack)
to	recv |	msg	-	pdue
	hops |	post	addr	-

where:
	msg is the message being delivered
	post is postage paid by the sender
	addr is addressing info from the receiver
	pneed is info to help sender provide postage
	pdue is info on missing postage
	(ack) is info that is disallowed

pneed is cleartext on the outside of the envelope.  This leaves us
with the message, and three parts of the envelope: the delivery
address, postage paid, and postage due.

Note that information other than what I'm describing here could be
sent along these channels; I am simply using postage as a concrete
example of information that might need to be transmitted.

And now, let's trace a message through to its delivery.  Being stuck
with ascii, the notation is not wonderful.  Groups of letters
represent sets of similar things.  Case is significant.  Lower case
letters r and v-z are public keys.  Upper case letters preceded by &amp;
are the machines that know the associated secret keys (from the C
address of operator).  So machine &amp;Y can decrypt something encrypted
with public key y.  Upper case letters A-F are conventional keys.
Keys A-C are generated by the sender, keys D-F by the receiver.  The
symbols P, S, Q, $, and # are followed by lower case letters
indicating who the item is associated with.  Q and # are conventional
keys, P and S form a public key-secret key pair, and $ is a digicash
stamp.

NOTATION:
	x(...)	contents encrypted with public key x
	&amp;X	mail address for remailer using public key x
	A(...)	contents encrypted with conventional key A
	Px	public key for delivering postage to &amp;X
	Sx	secret key for delivering postage to &amp;X
	Qx	conventional key for postage due from &amp;X
	$x	a postage stamp for &amp;X to cash
	Amt_x	an amount of postage to deliver to &amp;X
	Due_x	postage still due to &amp;X, plus a unique ID
	#x	conventional key held by &amp;X while postage is due
	pad	random padding (see below)
	&amp;R	mail address of the final recipient
	Pr, Qr, $r
		stuff associated with &amp;R
	M	the actual message to be delivered to &amp;R
	junk	padding created by &amp;R as a diversion

ABOUT PADDING:

K(stuff, pad) can be transformed into stuff by decrypting with key K.
Since stuff has a length associated with it inside the encryption, an
external viewer cannot tell the length of stuff.  It is also possible
to turn K(stuff) into K(stuff, pad) without knowing K.  The encryption
packet contains an external length as well as the internal length.
The external length must be adjusted to cover the added padding, which
is just a random bitstream appended to the cyphertext.  Once this
padding has been performed, it is impossible to determine the length
of stuff without decrypting with K.  In this manner, a portion of a
message can be either lengthened or shortened at every step along the
way, as long as a decryption is performed at each step.  This is the
motivation for the keys A..F in the exchange that follows.

PGP should be augmented with a function to pad a message, and should
explicitly accept padded data.  I have tested PGP2.1 on Unix and it
accepts padded data that I manually added.

OK, here we go...  The envelope provided by the receiver to the sender
looks like this:

Addr: &amp;X, x, x(...)
Pneed: [Px, Amt_x], [Py, Amt_y], [Pz, Amt_z], [Pr, Amt_r]

Everything except the encrypted segment x(...) is considered public
knowledge.  The keys Px, etc... pose a slight problem: One of the hops
can identify which envelope a message is associated with by comparing
the postage key sealed inside the addressing info with this public
string of keys.  It's not clear how serious of an issue this is.

The sender decides to send the message through hosts &amp;V and &amp;W before
using the provided envelope.  She sends the following message to &amp;V:

Addr: v(A), v(Sv, Qv, B, &amp;W, w(B), w(Sw, Qw, C, &amp;X, x(C), x(...)), pad)
Post: A(Pv($v, Pw($w, Px($x, Py($y, Pz($z, Pr($r)))))), pad)
Pdue: A(pad)
Message: A(M, pad)

She has created keys A-C, Pv, Sv, Pw, Sw, Qv, and Qw.  She obtains the
specified postage stamps and wraps them in the various postage keys.
The keys and addresses get wrapped in public keys for the address
field, and all of the other elements of the message are sealed with
key A.  The address field consists of two public key encrypted
segments because the sender must create key C, but cannot seal it into
the packet that the recipient has provided for host &amp;X.  If C were
public knowledge, host &amp;X could be monitored, and the plaintext of M
revealed to an external watcher.  As it is, M still occurs in
plaintext within each remailer, so it should be protected by the
recipient's public key (i.e. M = r(the real message) ).

&amp;V decrypts the v() encryptions to find all of the keys necessary for
it to process the message.  The padding is removed from the address
field.  The key A unlocks the message M, allowing the stripping of the
padding, which is replaced with new padding before being encrypted
with key B.  It notes that the Pdue field is empty.  Sv allows it to
extract its postage stamp $v, and strip the padding.  The message it
sends to &amp;W looks like this:

Addr: w(B), w(Sw, Qw, C, &amp;X, x(C), x(...), pad)
Post: B(Pw($w, Px($x, Py($y, Pz($z, Pr($r))))), pad)
Pdue: B(pad)
Message: B(M, pad)

&amp;W does likewise, and sends the following to &amp;X (we have revealed the
encrypted part of the original envelope at this point):

Addr: x(C), x(Sx, Qx, D, &amp;Y, y(D), y(Sy, Qy, E, &amp;Z,
		z(E), z(Sz, Qz, F, &amp;R, r(junk), r(junk))), pad)
Post: C(Px($x, Py($y, Pz($z, Pr($r)))), pad)
Pdue: C(pad)
Message: C(M, pad)

Postage rates have gone up since the envelope was first issued, so &amp;X,
&amp;W, and &amp;Z will need to use the Pdue field.  It works like this:

Addr: y(D), y(Sy, Qy, E, &amp;Z,
		z(E), z(Sz, Qz, F, &amp;R, r(junk), r(junk)), pad)
Post: D(Py($y, Pz($z, Pr($r))), pad)
Pdue: D(Qx(Due_x), pad)
Message: D(#x(M), pad)

&amp;Y then sends the following to &amp;Z:

Addr: z(E), z(Sz, Qz, F, &amp;R, r(junk), r(junk), pad)
Post: E(Pz($z, Pr($r)), pad)
Pdue: E(Qy(Due_y, Qx(Due_x)), pad)
Message: E(#y(#x(M)), pad)

&amp;Z sends the following to &amp;R:

Addr: r(junk), r(junk, pad)
Post: F(Pr($r), pad)
Pdue: F(Qz(Due_z, Qy(Due_y, Qx(Due_x)), pad)
Message: F(#z(#y(#x(M))), pad)

Now, &amp;R (the receiver, who created the envelope in the first place)
knows F, Sr, Qx, Qy, Qz, and thus finds out Due_x, Due_y, Due_z,
#z(#y(#x(M))) [the message, with postage due], and gets a stamp $r.
&amp;R then generates a message that is designed to deliver #x, #y, and
#z, and sends it to &amp;X:

Addr: x(C), x(Sx, Qx, D, &amp;Y, y(D), y(Sy, Qy, E, &amp;Z,
		z(E), z(Sz, Qz, F, &amp;R, r(junk), r(junk))), pad)
Post: C(Px($x, Due_x, Py($y, Due_y, Pz($z, Due_z, Pr(junk)))), pad)
Pdue: C(pad)
Message: C(pad)

&amp;X unwraps it and sends #x along:

Addr: y(D), y(Sy, Qy, E, &amp;Z, z(E), z(Sz, Qz, F, &amp;R, r(junk), r(junk)), pad)
Post: D(Py($y, Due_y, Pz($z, Due_z, Pr(junk))), pad)
Pdue: D(Qx(#x), pad)
Message: D(pad)

And again:

Addr: z(E), z(Sz, Qz, F, &amp;R, r(junk), r(junk), pad)
Post: E(Pz($z, Due_z, Pr(junk)), pad)
Pdue: E(Qy(#y, Qx(#x)), pad)
Message: E(pad)

And back to &amp;R:

Addr: r(junk), r(junk, pad)
Post: F(Pr(junk), pad)
Pdue: F(Qz(#z, Qy(#y, Qx(#x))), pad)
Message: F(pad)

So &amp;R now knows #x, #y, and #z, and so can recover M.

To keep &amp;Z from knowing it is the tail of the path, extra postage
stamps are required of the sender.  These are cashable by the
receiver.  The sender thus has no way of knowing the length of the
path, but only has an idea of the upper bound on it.  If the sender
does not include sufficient postage on the steps she prepended to the
path, the receiver will not be able to read the message, as there is
no way for the receiver to find out Qv and Qw.  Perhaps these could be
affixed to the innermost stamp, along with &amp;V and &amp;W, but this is
probably not a good idea.

Since remailers wouldn't add extra encryption to the header fields of
a postage due message (it would make paying the postage due a lengthy
process), the postage due concept could be circumvented by placing the
message in the Post or Pdue headers disguised as postage info.  To
discourage this, remailers would only allow postage due deliveries for
a fixed period after a rate increase, and would still require the
older rate be paid.

Another use for postage due would be to disguise the use of an
expensive remailer.  Such a remailer would forward with postage due
when paid the prevailing rate.



Well, I've beaten this thing bloody now and can't find any more flaws.
I admit it's a bit of a monster, but most of it goes away if you don't
require postage.  I think the system needs to be designed with postage
in mind from the start, however.  Anyway, it's time for you people to
start ripping it apart.  Perhaps we can have a discussion of this at
the physical meeting this week if Eric Hughes can fit it into the
schedule.

-eric messick





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1993/01">January 1993</a><li><p>1993-01-14 (Wed, 13 Jan 93 18:07:53 PST) - Details on return envelopes - <em>eric@parallax.com (Eric Messick)</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
