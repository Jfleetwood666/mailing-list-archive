<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="5b20dcee6126d4e27d171345bc313b7bdbf49586a57becb94c9f552a6d8518f6" /><meta name="keywords" content="5b20dcee6126d4e27d171345bc313b7bdbf49586a57becb94c9f552a6d8518f6, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="5b20dcee6126d4e27d171345bc313b7bdbf49586a57becb94c9f552a6d8518f6" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1993/01/5b20dcee6126d4e27d171345bc313b7bdbf49586a57becb94c9f552a6d8518f6/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="5b20dcee6126d4e27d171345bc313b7bdbf49586a57becb94c9f552a6d8518f6"><meta name="twitter:url" content="http://localhost:4000/archive/1993/01/5b20dcee6126d4e27d171345bc313b7bdbf49586a57becb94c9f552a6d8518f6/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1993-01-10---trailing-blanks-in-pgp">1993-01-10 - Trailing blanks in PGP</h1><h2 id="header-data">Header Data</h2><p>From: Hal &lt;74076.1041<span>@</span>CompuServe.COM&gt;<br /> To: Cypherpunks &lt;cypherpunks@toad.com&gt;<br /> Message Hash: 5b20dcee6126d4e27d171345bc313b7bdbf49586a57becb94c9f552a6d8518f6<br /> Message ID: &lt;930110010447<em>74076.1041_DHJ70-1@CompuServe.COM&gt;<br /> Reply To: _N/A</em><br /> UTC Datetime: 1993-01-10 01:12:59 UTC<br /> Raw Date: Sat, 9 Jan 93 17:12:59 PST<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Hal &lt;74076.1041@CompuServe.COM&gt;
Date: Sat, 9 Jan 93 17:12:59 PST
To: Cypherpunks &lt;cypherpunks@toad.com&gt;
Subject: Trailing blanks in PGP
Message-ID: &lt;930110010447_74076.1041_DHJ70-1@CompuServe.COM&gt;
MIME-Version: 1.0
Content-Type: text/plain


Edgar points out that PGP prepends a "- " string to every line that starts
with "-", and suggests that it would not be much further to go to strip
trailing blanks.
 
While I sympathize with the problems Edgar and others have with trailing
blanks messing up signature checking, it turns out that the "- " quoting is
done at a different stage of the processing than signature checking.
 
When a signed message is created, it is first "canonicalized", which
presently means only that each line is made to end with a carriage return
line feed.  The signature is then calculated on this form.  For the
cleartext signature, the message is then wrapped in the "-----BEGIN PGP
MESSAGE-----" lines, and the quoting of lines starting with "-" is done.  As
Edgar surmises, this quoting is so that the end of the message can be
accurately located, even if the message contains lines like "-----END PGP
MESSAGE-----".
 
On the receiving end, the message is first stripped of the -----BEGIN and
-----END lines, and the "-" quoting is undone.  The resulting message is
then canonicalized (so that lines end with CRLF's) and the signature is
calculated and checked against that sent with the message.
 
Space stripping could be done fairly easily in the "unwrapping" process, along
with the "-" de-quoting, as Edgar suggests.  But it would still fail if the
user signed a message which ended a line with a blank.  In fact, if he ever
did sign such a message, and the de-quoting routine were enhanced to strip
trailing blanks, the message would always fail the signature check, because
that necessary trailing blank will be gone.
 
What really needs to be done is to change the definition of a "canonical
text" message.  Presently it only specifies CRLF line terminators.  It would
have to be enhanced to specify also that no spaces precede any CRLF.  If
this were done, then the canonicalizing process done at both ends would
strip the trailing blanks before calculating the signature, and therefore
trailing blanks would not affect the signature check.
 
Presently, PGP "knows" that on a PC, canonical text form is the same as
regular text form.  That is because CRLF is the normal line terminator on a
PC.  So, canonicalizing is skipped on the PC, which speeds up signing and
verification on this class of machines, which include some of the slowest on
which PGP is run.  Adding blank-stripping to the definition of canonical
text means that all messages will have to be canonicalized on PC's, thus
adding an extra processing pass which is avoided now.  So there is some cost
in doing this.
 
There are also some compatibility problems, in that old signed messages
which had trailing blanks would no longer signature-verify if we changed the
definition of canonical text in this way.  However, there probably aren't
that many such messages, so this may be a tolerable cost.
 
I do think we should consider making this change, as many people have
complained about it.
 
Hal Finney
74076.1041@compuserve.com



Distribution:
  Cypherpunks &gt;INTERNET:cypherpunks@toad.com






</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1993/01">January 1993</a><li><p>Return to “<a href="/authors/hal_74076_1041_at_compuserve_com_">Hal &lt;74076.1041<span>@</span>CompuServe.COM&gt;</a>”<li><p>1993-01-10 (Sat, 9 Jan 93 17:12:59 PST) - Trailing blanks in PGP - <em>Hal &lt;74076.1041@CompuServe.COM&gt;</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
