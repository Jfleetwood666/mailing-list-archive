<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="Da176b8dea511caab7d3ec609aa295ff85f9112f3a2a23de969976d45e4022c1" /><meta name="keywords" content="Da176b8dea511caab7d3ec609aa295ff85f9112f3a2a23de969976d45e4022c1, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="Da176b8dea511caab7d3ec609aa295ff85f9112f3a2a23de969976d45e4022c1" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1993/08/da176b8dea511caab7d3ec609aa295ff85f9112f3a2a23de969976d45e4022c1/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="Da176b8dea511caab7d3ec609aa295ff85f9112f3a2a23de969976d45e4022c1"><meta name="twitter:url" content="http://localhost:4000/archive/1993/08/da176b8dea511caab7d3ec609aa295ff85f9112f3a2a23de969976d45e4022c1/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1993-08-26---re-source-code-not-available-for-viacrypt-pgp">1993-08-26 - Re: Source Code NOT available for ViaCrypt PGP</h1><h2 id="header-data">Header Data</h2><p>From: norm<span>@</span>netcom.com (Norman Hardy)<br /> To: cypherpunks@toad.com<br /> Message Hash: da176b8dea511caab7d3ec609aa295ff85f9112f3a2a23de969976d45e4022c1<br /> Message ID: &lt;9308262139.AA05382@netcom3.netcom.com&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1993-08-26 21:42:34 UTC<br /> Raw Date: Thu, 26 Aug 93 14:42:34 PDT<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: norm@netcom.com (Norman Hardy)
Date: Thu, 26 Aug 93 14:42:34 PDT
To: cypherpunks@toad.com
Subject: Re: Source Code NOT available for ViaCrypt PGP
Message-ID: &lt;9308262139.AA05382@netcom3.netcom.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


Regarding Secret key generation.
cme@ellisun.sw.stratus.com (Carl Ellison) says:
&gt; The only place to worry is with key generation,
&gt; both IDEA and RSA.
I presume this is true.
 
I include a Scheme program that finds the first
prime in an arithmetic sequence. It uses a function published in Knuth.
You can either study my program or compare its output with some program
written by someone else to the same spec. If people are interested
I will annotate the code and its output better. As it is now
the prime that it finds is the last number that it outputs before it stops.
Curiously it has a probability of error which is large for small numbers
but exceedingly small for large numbers, just the opposite of human testers.
I claim that this is a good specification for choosing your secret primes.
It has a slight advantage over merely finding the first prime beyond some
specified number because that tends to find primes that follow long runs of
composites. It just now (as I edited this) found the prime 1000000000000000
00000000000000000000000000000000000000000000000000000000000000913
as the first prime in the sequence 10^80+11*n. I typed (scan (expt 10 80) 11)
to the interpreter to get this. It took several minutes.
I used MacGambit on a 68030.
The output theoretically depends on the hokey random number generator here
but if two implementations yield different answers due to different random
number generators Knuth and others would be very interested!
For use in real RSA application we should include a function that hashes
typed in text into a bignum. A good hash of long text is a very good
random number! It need not be a crypto hash!
 
(define (ex x)(write x)x)
(define (rand31 seed) (lambda()(let* ((hi (quotient seed 127773))
(lo (- seed (* 127773 hi)))(test (- (* 16807 lo) (* 2836 hi))))
(set! seed (if (&gt; test 0) test (+ test 2147483647))) seed)))
(define (gbrand max seed)(let* ((rq (rand31 seed))
  (nq (let v ((c max)(n 0))(if (&lt; c (expt 2 31))
   (cons (let w ((cx c)(nx 1))(if (&lt; cx 2) nx (w (quotient cx 2)(+ nx 1))))n)
  (v (quotient c (expt 2 31))(+ n 1)))))
  (z (car nq))(n (cdr nq))(k (+ (* 31 n) z)))
(write(list max k z n))
; max, k, n, z, L and m are non-negative integers.
; 2^(k-1)&lt;=max&lt;2^k. k=31*n+z. 0&lt;z&lt;=31. 
; I claim this code is efficient if 
; (quotient .. (expt 2 ..)) and (modulo .. (expt 2 ..)) are efficient.
  (if (= n 0)(lambda () (let r ()(let ((q (modulo (rq) (expt 2 z))))
     (if (&lt; q max) q (r)))))
  (let ((L (quotient max (expt 2 (- k 31)))))(write L)
; max = L*2^(k-31) + m; 0&lt;=m&lt;2^(k-31). L is the high 31 bits of max.
    (lambda()(+ (* (expt 2 z)(let g ((nx n))(if (= nx 1)
    (let r ()(let ((q (rq)))(if (&lt; q L) q (r))))
   (+ (* (expt 2 31)(g (- nx 1)))(rq)))))(modulo (rq)(expt 2 z))))))))
 
(load "Random.scm")
(define ww (lambda(n x)(display (list n x)) x))
; The following definition is to ensure that modulo never
; produces negative numbers.
(define modulo (let ((modulo modulo))(lambda (a m)
   (if (negative? a) (- (- m 1) (modulo (-(- m 1) a) m))
   (if (positive? a) (modulo a m) 0)))))
; The following is the "Jacobi Symbol". (a|P)
(define (j a P) (if (&lt; a 2) (if (= a 1) 1
      (if (= a 0) 0 (j (modulo a P) P)))
   (if (&gt;= a P) (j (modulo a P) P)
   (if (even? a) (let((q (j (/ a 2) P))
   (m (modulo P 8))) (if (or (= m 3)(= m 5))(- q) q))
   (let((q (j (modulo P a) a)))
   (if(or (= (modulo P 4) 1) (= (modulo a 4) 1)) q (- q)))))))
(define (mod-exp b p m)(cond ((= p 0) 1)
   ((even? p)(let ((x (mod-exp b (/ p 2) m)))(modulo (* x x)m)))
   (#t (modulo (* b (mod-exp b (- p 1) m)) m))))
; The following is by Solovay &amp; Strassen as presented in Knuth page 396.
(define (p-test a P)(if(zero? a)(cdr 2))(and (odd? P) (= (gcd a P) 1)
   (zero? (modulo (- (j a P)(mod-exp a (/(- P 1) 2) P)) P))))
(quote "The function scan below returns the first prime in the")
(quote "arithmetic sequence a + n*b")
(define (scan a b)(let* ((g (gcd a b))(n (modulo b 210))
  (random (gbrand (+ a (if (positive? b) 0 (* 2000 b))) 228765))
  (probe (+ 1 (random))))
   (if (&gt; g 1) (list "Always divisible by" g)
     (let more ((a1 a)(m (modulo a 210))(cn 0))
    (if (and (let all ((l (list 2 3 5 7)))(or (null? l)
      (and (positive? (remainder m (car l))) (all (cdr l)))))
        (let all ((l 20)(p probe)) (or (zero? l)
          (and (ww cn (pt p a1))
      (all (- l 1)(+ 1 (random)))))))
      a1
      (begin (display ",")(more (+ a1 b)(modulo (+ m n) 210)(+ cn 1))))))))
(define (pc wx) (let zz ((q (- wx 1))(s 0))(if (zero? q) s
   (zz (- q 1)(+ (if (p-test q wx) 1 0) s)))))
; The following prmality test is from second edition of
; volume 2 of Knuth's "The Art of Computer Programming",
; page 379.
(define (pt x n) (or (= n 2)
   (let* ((pr (let z ((q (- n 1))(k 0))(if (odd? q)(cons q k)
               (z (quotient q 2)(+ k 1)))))
          (q (car pr))(k (cdr pr))(nm1 (- n 1)))
   (let lp ((j 0)(y (mod-exp x q n)))
       (or (and (= j 0)(= y 1)) (= y nm1)
       (and (&lt; (+ j 1) k)(lp (+ j 1)(modulo (* y y) n))))))))
 ; 10^100-797, 10^200-189, 10^299-171, 10^300-69 are prime.
 ~.
 ~.





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1993/08">August 1993</a><li><p>Return to “<a href="/author/norm_at_netcom_com_norman_hardy_">norm<span>@</span>netcom.com (Norman Hardy)</a>”<li><p>1993-08-26 (Thu, 26 Aug 93 14:42:34 PDT) - Re: Source Code NOT available for ViaCrypt PGP - <em>norm@netcom.com (Norman Hardy)</em></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
