<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="8e4aa4e3e77e281fbc832ca461c40c4ff99498f165150c1771c007a623b18c73" /><meta name="keywords" content="8e4aa4e3e77e281fbc832ca461c40c4ff99498f165150c1771c007a623b18c73, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="8e4aa4e3e77e281fbc832ca461c40c4ff99498f165150c1771c007a623b18c73" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1996/10/8e4aa4e3e77e281fbc832ca461c40c4ff99498f165150c1771c007a623b18c73/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="8e4aa4e3e77e281fbc832ca461c40c4ff99498f165150c1771c007a623b18c73"><meta name="twitter:url" content="http://localhost:4000/archive/1996/10/8e4aa4e3e77e281fbc832ca461c40c4ff99498f165150c1771c007a623b18c73/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1996-10-27---re-some-rsa-questions">1996-10-27 - Re: some RSA questions</h1><h2 id="header-data">Header Data</h2><p>From: “Mark M.” &lt;markm<span>@</span>voicenet.com&gt;<br /> To: jk@stallion.ee&gt;<br /> Message Hash: 8e4aa4e3e77e281fbc832ca461c40c4ff99498f165150c1771c007a623b18c73<br /> Message ID: &lt;Pine.LNX.3.95.961027121320.180A-100000@gak.voicenet.com&gt;<br /> Reply To: &lt;Pine.GSO.3.93.961027154749.25956C-100000@nebula&gt;<br /> UTC Datetime: 1996-10-27 16:23:28 UTC<br /> Raw Date: Sun, 27 Oct 1996 08:23:28 -0800 (PST)<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: "Mark M." &lt;markm@voicenet.com&gt;
Date: Sun, 27 Oct 1996 08:23:28 -0800 (PST)
To: jk@stallion.ee&gt;
Subject: Re: some RSA questions
In-Reply-To: &lt;Pine.GSO.3.93.961027154749.25956C-100000@nebula&gt;
Message-ID: &lt;Pine.LNX.3.95.961027121320.180A-100000@gak.voicenet.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


-----BEGIN PGP SIGNED MESSAGE-----

On Sun, 27 Oct 1996, Jüri Kaljundi wrote:

&gt; The question is easy: how should I sign and encrypt the message?
&gt; 
&gt; 1) calculate a digest (MD5, SHA) from the message, sign the digest (or
&gt; should I sign the message contents + digest) with Bob's private key and
&gt; encrypt it with Alice's public key?

This is the best way.  The message plus the signature should be encrypted
using a symmetric algorithm and encrypt the key with Alice's public key.
All RSA encryption and signing should be done according to the PKCS standard
to avoid several nasty attacks that are successful if plain RSA is used.

&gt; 2) is there any idea to generate a DES key, encrypt the message with the
&gt; DES key, calculate a digest on (enc. message + DES key), sign the digest
&gt; and encrypt it with Alice's public key? The message is small, so the time
&gt; it takes to encrypt the message is not so important compared to higher
&gt; speed of DES.

It is generally not a good idea to sign an encrypted message.  The signature
should be calculated on the plaintext, not ciphertext.

&gt; 3) may be it would be good to encrypt the message with Alice's public key,
&gt; then generate a digest, sign the digest and then once more encrypt the
&gt; whole thing with Alice's public key?

This has the same problem as #2.

&gt; Using a DES session key helps in case someone would find out Alice's
&gt; private key she uses to decrypt the message, but actually in this case it
&gt; is not so important to hide the message contents (what is important are
&gt; message integrity and sender authentication).
&gt; 
&gt; What are the suggestions what crypto package might I use: RSAref,
&gt; crypto++, SSLeay or some other? 

SSLeay is pretty fast and does have code to use PKCS.  It probably doesn't make
that much of a difference.  RSAref isn't necessary; RSA isn't patented outside
the USA.  The other packages are faster and better than RSAref.

Mark
- -- 
finger -l for PGP key
PGP encrypted mail prefered.

-----BEGIN PGP SIGNATURE-----
Version: 2.6.3
Charset: noconv

iQEVAwUBMnOazizIPc7jvyFpAQEx3Qf+M0BnhAcis6qzcsaVyRYyU13xvZArlx6I
7zupsL8y/CozpIyvgo23qpEd8ShR0k+I+ZlqbpEuprFXEtC+i5cO8i+EECKY22i6
R/4aAer0jMKZdovnxI/IHZ6boLengf4AcO9RE6tVm0chMbHyfn+j0e8FjtVKAoQe
SPS+QHT6225ro62hoWWBcQtoL5ifbOn6lyIZk6lMGZzEnknXejLB/i5Uz5VMLyCh
rsB4zNkpO5NCyHHscW5CdCV800+J5qRyzWCMxEM8GVtXmhm2vciOgGHhypJW37T9
PFv9Mft2m+d2QAK9JosHaGEbVJ3zgGsqDrxmgqI+v6Sf8jceWKNw6A==
=pBlb
-----END PGP SIGNATURE-----






</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1996/10">October 1996</a><li>Return to “<a href="/author/iso88591qjfcri_kaljundi_jk_at_stallion_ee_">=?ISO-8859-1?Q?J=FCri_Kaljundi?= &lt;jk<span>@</span>stallion.ee&gt;</a>”<li><p>Return to “<a href="/author/mark_m__markm_at_voicenet_com_">“Mark M.” &lt;markm<span>@</span>voicenet.com&gt;</a>”<li>1996-10-27 (Sun, 27 Oct 1996 06:47:15 -0800 (PST)) - <a href="/archive/1996/10/e6ff5b24aa92aae2be8b91c218a107bc9adcf56a4476ee066b16ed9579f97dfb">some RSA questions</a> - <em>=?ISO-8859-1?Q?J=FCri_Kaljundi?= &lt;jk@stallion.ee&gt;</em><ul><li>1996-10-27 (Sun, 27 Oct 1996 08:23:28 -0800 (PST)) - Re: some RSA questions - <em>“Mark M.” &lt;markm@voicenet.com&gt;</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
