<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="Dcdad46b0538142085a5e9efba573a40968bd1ec49adbbf5e8a78e290d0f5add" /><meta name="keywords" content="Dcdad46b0538142085a5e9efba573a40968bd1ec49adbbf5e8a78e290d0f5add, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="Dcdad46b0538142085a5e9efba573a40968bd1ec49adbbf5e8a78e290d0f5add" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1996/01/dcdad46b0538142085a5e9efba573a40968bd1ec49adbbf5e8a78e290d0f5add/" property="og:url"><meta content="2018-06-21T22:53:40+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="Dcdad46b0538142085a5e9efba573a40968bd1ec49adbbf5e8a78e290d0f5add"><meta name="twitter:url" content="http://localhost:4000/archive/1996/01/dcdad46b0538142085a5e9efba573a40968bd1ec49adbbf5e8a78e290d0f5add/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1996-01-18---re-a-weakness-in-pgp-signatures-and-a-suggested-solution">1996-01-18 - Re: A weakness in PGP signatures, and a suggested solution</h1><h2 id="header-data">Header Data</h2><p>From: Eric Murray &lt;ericm@lne.com&gt;<br /> To: warlord@ATHENA.MIT.EDU (Derek Atkins)<br /> Message Hash: dcdad46b0538142085a5e9efba573a40968bd1ec49adbbf5e8a78e290d0f5add<br /> Message ID: &lt;199601180442.UAA15648@slack.lne.com&gt;<br /> Reply To: &lt;199601180344.WAA26221@charon.MIT.EDU&gt;<br /> UTC Datetime: 1996-01-18 04:54:34 UTC<br /> Raw Date: Thu, 18 Jan 1996 12:54:34 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Eric Murray &lt;ericm@lne.com&gt;
Date: Thu, 18 Jan 1996 12:54:34 +0800
To: warlord@ATHENA.MIT.EDU (Derek Atkins)
Subject: Re: A weakness in PGP signatures, and a suggested solution
In-Reply-To: &lt;199601180344.WAA26221@charon.MIT.EDU&gt;
Message-ID: &lt;199601180442.UAA15648@slack.lne.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


Derek Atkins writes:
[Dr Dimitri writes:]
&gt; 
&gt; &gt; 2. When PGP verified the signature, it should have an option to look outside
&gt; &gt; the signed portion for RFC 822 headers and compare them to the signed copy
&gt; &gt; of he headers inside. If this is not in PGP, then then function would have to
&gt; &gt; be done by some non-portable wrapper.
&gt; &gt; (Of course, if your headers aren't RFC 822, you're out of luck.)
 
[..]
 
&gt; PGP really only looks at the contents between the BEGIN and END.  It
&gt; can't do anything else.  In fact, only the PGP Armor code even deals
&gt; with that.  By definition, PGP is a binary protocol and deal with
&gt; binary data objects.  So how can it look at any "RFC 822 Headers"?
&gt; There are no such animals in PGP.  It is perfectly legal to remove all
&gt; data before the BEGIN and all data after then END and feed the result
&gt; to PGP...
&gt; 
&gt; As I said, armor is a convenience to the user only.
&gt; 
&gt; PGP will not be modified in this way; it is the job of the mailer
&gt; (MUA) to do this sort of thing.  Sorry.

I agree.
PGP should be as generic as possible; making it "know" about RFC822
and mailers makes it less generic.

Your PGP-aware mail agent should add a line to the text to be
encrypted, consisting of a random number (hopefully very unguessable
and fairly random) and an RFC822 header:

X-PGP-nonce: b1de70694f5f0824f89cb3f09aece01d

and replicate that in the RFC822 envelope.
Put just the nonce value and not the header in the block to be
encrypted if you're concerned about assisting a known-plaintext attack.

The nonce can't be extracted from the PGP ciphertext unless the attacker
has the ability to crack PGP, in which case merely re-directing
PGP encrypted messages to different recipients is beneath them. :-)
It is small and is easily verified by the human looking at the message.
PGP, or more accurately the MUA, won't need to check it (although
that would be fairly easy to do).

But like Derek says, PGP shouldn't do it, the MUA should.

-- 
Eric Murray  ericm@lne.com  ericm@motorcycle.com  http://www.lne.com/ericm
PGP keyid:E03F65E5 fingerprint:50 B0 A2 4C 7D 86 FC 03  92 E8 AC E6 7E 27 29 AF





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1996/01">January 1996</a><li><p>1996-01-17 (Thu, 18 Jan 1996 00:39:17 +0800) - <a href="/archive/1996/01/a1f3b4f34e715e5bc22f9294a0852eb154c9c7d4188b9075a0577c9f5380bfef">Re: A weakness in PGP signatures, and a suggested solution</a> - <em>“Brian C. Lane” &lt;blane@eskimo.com&gt;</em><ul><li>1996-01-18 (Thu, 18 Jan 1996 09:11:36 +0800) - <a href="/archive/1996/01/120d060dc6eb9a25c83f1c1a17c1ddf65ee4190098eddc8ce84b541bcaf37a51">Re: A weakness in PGP signatures, and a suggested solution</a> - <em>dlv@bwalk.dm.com (Dr. Dimitri Vulis)</em><ul><li>1996-01-21 (Sun, 21 Jan 1996 17:19:12 +0800) - <a href="/archive/1996/01/d883bce4fa12e766a7a8bac7aef32e385feb278bf68cb63a04e139511f5c69b9">Re: A weakness in PGP signatures, and a suggested solution</a> - <em>Derek Atkins &lt;warlord@ATHENA.MIT.EDU&gt;</em><ul><li>1996-01-18 (Thu, 18 Jan 1996 12:54:34 +0800) - Re: A weakness in PGP signatures, and a suggested solution - <em>Eric Murray &lt;ericm@lne.com&gt;</em><ul><li>1996-01-18 (Thu, 18 Jan 1996 13:03:43 +0800) - <a href="/archive/1996/01/f628b298f933a6ddfa473917ee94b96977bb204e3d34da26a7c2b5ad763c409a">Re: A weakness in PGP signatures, and a suggested solution</a> - <em>Derek Atkins &lt;warlord@ATHENA.MIT.EDU&gt;</em></ul></ul></ul></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
