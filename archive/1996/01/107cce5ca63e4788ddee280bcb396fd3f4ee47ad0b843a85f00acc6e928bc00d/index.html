<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/static/img/favicons/favicon.ico" />
    <link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="/static/img/favicons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title>
    <meta name="author" content="cryptoanarchy.wiki" />
    <meta name="description" content="107cce5ca63e4788ddee280bcb396fd3f4ee47ad0b843a85f00acc6e928bc00d" />
    <meta name="keywords" content="107cce5ca63e4788ddee280bcb396fd3f4ee47ad0b843a85f00acc6e928bc00d, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
    <meta content="" property="fb:app_id">
    <meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name">

    

    
      <meta content="107cce5ca63e4788ddee280bcb396fd3f4ee47ad0b843a85f00acc6e928bc00d" property="og:title">
      <meta content="article" property="og:type">
    

    
      <meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description">
    

    
      <meta content="http://localhost:4000/archive/1996/01/107cce5ca63e4788ddee280bcb396fd3f4ee47ad0b843a85f00acc6e928bc00d/" property="og:url">
    

    
      <meta content="2018-06-20T21:43:48+02:00" property="article:published_time">
      <meta content="http://localhost:4000/about/" property="article:author">
    

    
      <meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image">
    

    
      
    

    
      
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@_cryptoanarchy">
    <meta name="twitter:creator" content="@_cryptoanarchy">

    
      <meta name="twitter:title" content="107cce5ca63e4788ddee280bcb396fd3f4ee47ad0b843a85f00acc6e928bc00d">
    

    
      <meta name="twitter:url" content="http://localhost:4000/archive/1996/01/107cce5ca63e4788ddee280bcb396fd3f4ee47ad0b843a85f00acc6e928bc00d/">
    

    
      <meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!">
    

    

    <!-- Font awesome icons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/static/css/syntax.css">
    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/super-search.css">
    <link rel="stylesheet" href="/static/css/thickbox.css">
    <link rel="stylesheet" href="/static/css/projects.css">
    <link rel="stylesheet" href="/static/css/main.css">

    
  </head>
  <body>
    <div class="container">
      <div class="col-sm-3">
        <div class="fixed-condition">
          <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a>
          <h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1>
          
            <div class="profile-about">
              Arise, you have nothing to lose but your barbed wire fences!
            </div>
          
          <div class="social">
            <ul>
              
                <li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a></li>
              
                <li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a></li>
              
                <li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></li>
              
            </ul>
          </div>
          <hr />
          <ul class="sidebar-nav">
            <strong>Navigation</strong>
            <li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a></li>
            <li><a href="/">Archive Home</a></li>
          </ul>
          <hr>
          <ul class="sidebar-nav">
            <strong>Similar Resources</strong>
            
              <li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a></li>
            
              <li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a></li>
            
              <li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></li>
            
          </ul>
        </div>
        <!-- end /.fixed-condition -->
      </div>
      <div class="col-sm-8 col-offset-1 main-layout">
        <h1 id="1996-01-16---how-to-make-someone-else-lose-ecash">1996-01-16 - How to make someone else lose ecash</h1>

<h2 id="header-data">Header Data</h2>

<p>From: Ian Goldberg &lt;iang@CS.Berkeley.EDU&gt;<br />
To: cypherpunks@toad.com<br />
Message Hash: 107cce5ca63e4788ddee280bcb396fd3f4ee47ad0b843a85f00acc6e928bc00d<br />
Message ID: &lt;199601160014.QAA20158@lagos.CS.Berkeley.EDU&gt;<br />
Reply To: <em>N/A</em><br />
UTC Datetime: 1996-01-16 00:14:41 UTC<br />
Raw Date: Mon, 15 Jan 96 16:14:41 PST<br /></p>

<h2 id="raw-message">Raw message</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Ian Goldberg &lt;iang@CS.Berkeley.EDU&gt;
Date: Mon, 15 Jan 96 16:14:41 PST
To: cypherpunks@toad.com
Subject: How to make someone else lose ecash
Message-ID: &lt;199601160014.QAA20158@lagos.CS.Berkeley.EDU&gt;
MIME-Version: 1.0
Content-Type: text/plain


I don't recall seeing this on cypherpunks or on ecash@digicash.com;
it's being sent to both places, so set your replies appropriately.

Dave and I were discussing the ecash protocols when we discovered
what seems to be a way for Eve (a passive eavesdropper) to cause
anyone to lose money.  Note that she doesn't gain anything from it.

Eve watches for any message that contains pcoins (a list of onl_coin).
These messages are the Payment (from user to shop) and Deposit (from
shop to mint).  Neither of these are required to be encrypted.

An onl_coin is the following:

onl_coin =
      [
        int     keyversion              ; low 5 bits are denomination
        MPI     n                       ; coin number
        MPI     sig                     ; encrypted coin signature
      ]

sig is (f(n)^(1/h) XOR f(payment_hdr)), encrypted in the mint's public key.

The reason sig is encrypted is so that the payment header can't be
changed and so that Eve can't learn f(n)^(1/h).  However, n is sitting
there all nice and cleartext.

Therefore: when Eve sees such a message, she uses the same value of n
to withdraw a coin from her bank account, and then spends it (she could
just pay it to herself).  Eve does not gain or lose anything, but if
she can deposit the coin before the original coin that she saw gets to
the mint, the original coin will not clear.  If Eve has the ability
to drop or delay packets, she can accomplish this easily.  The result
is that whoever withdrew the coin originally has lost the use of that
coin.

Note that this is the same problem as if two users just happen to use
the same value of n when they withdraw coins.  We don't really care
about that, since the probability is trivial.  However, this attack
lets Eve produce the same effect _on purpose_.

How can we prevent this?  Well, since a shop has no way of using the
value n except for just sending it on to the mint, we lose nothing by
encrypting it.  Thus, an onl_coin should be:

onl_coin =
      [
	    int     keyversion              ; low 5 bits are denomination
	Encrypt_with_mint_public_key(
	    MPI     n                       ; coin number
	    MPI     sig                     ; (f(n)^(1/h) XOR f(payment_hdr))
	)
      ]

Note that it's not really necessary to have sig already encrypted if
we're going to encrypt it again.  Actually, I think an onl_coin
should have an additional field (bankID) to the fields listed
above, but that's another argument for another time.

   - Ian "Back from the North and ready to party!"




</code></pre></div></div>

<h2 id="thread">Thread</h2>

<ul>
  <li>
    <p>Return to <a href="/archive/1996/01">January 1996</a></p>
  </li>
  <li>
    <p>1996-01-16 (Mon, 15 Jan 96 16:14:41 PST) - How to make someone else lose ecash - <em>Ian Goldberg &lt;iang@CS.Berkeley.EDU&gt;</em></p>
  </li>
</ul>


        <footer>
          
            - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a>
          
        </footer>
      </div>
      <!-- end /.col-sm-8 -->
    </div>
    <!-- end /.container -->

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/super-search.js"></script>
    <script src="/static/js/thickbox-compressed.js"></script>
    <script src="/static/js/projects.js"></script>
  </body>
</html>

