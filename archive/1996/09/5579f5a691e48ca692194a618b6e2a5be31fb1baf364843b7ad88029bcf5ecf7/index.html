<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="5579f5a691e48ca692194a618b6e2a5be31fb1baf364843b7ad88029bcf5ecf7" /><meta name="keywords" content="5579f5a691e48ca692194a618b6e2a5be31fb1baf364843b7ad88029bcf5ecf7, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="5579f5a691e48ca692194a618b6e2a5be31fb1baf364843b7ad88029bcf5ecf7" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1996/09/5579f5a691e48ca692194a618b6e2a5be31fb1baf364843b7ad88029bcf5ecf7/" property="og:url"><meta content="2018-06-21T22:53:40+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="5579f5a691e48ca692194a618b6e2a5be31fb1baf364843b7ad88029bcf5ecf7"><meta name="twitter:url" content="http://localhost:4000/archive/1996/09/5579f5a691e48ca692194a618b6e2a5be31fb1baf364843b7ad88029bcf5ecf7/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1996-09-01---re-elliptic-curve-y2--x3--a--x2--b">1996-09-01 - Re: Elliptic Curve Y<strong>2 = x</strong>3 + a * x**2 + b</h1><h2 id="header-data">Header Data</h2><p>From: chen@chen.com (Mark Chen)<br /> To: weidai@eskimo.com (Wei Dai)<br /> Message Hash: 5579f5a691e48ca692194a618b6e2a5be31fb1baf364843b7ad88029bcf5ecf7<br /> Message ID: &lt;9609010250.AA00997@pela.chen.com.&gt;<br /> Reply To: &lt;Pine.SUN.3.95.960829124919.16763B-100000@eskimo.com&gt;<br /> UTC Datetime: 1996-09-01 04:43:41 UTC<br /> Raw Date: Sun, 1 Sep 1996 12:43:41 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: chen@chen.com (Mark Chen)
Date: Sun, 1 Sep 1996 12:43:41 +0800
To: weidai@eskimo.com (Wei Dai)
Subject: Re: Elliptic Curve Y**2 = x**3 + a * x**2 + b
In-Reply-To: &lt;Pine.SUN.3.95.960829124919.16763B-100000@eskimo.com&gt;
Message-ID: &lt;9609010250.AA00997@pela.chen.com.&gt;
MIME-Version: 1.0
Content-Type: text/plain


Wei Dai writes:
&gt; On Thu, 29 Aug 1996, Tom Rollins wrote:
&gt; 
&gt; &gt; Questions are:
&gt; &gt; 
&gt; &gt;   1: How can I take the suqare root mod p ?
&gt; 
&gt; Here's some C++ code for taking modular square roots:
&gt; 
&gt; Integer ModularSquareRoot(const Integer &amp;a, const Integer &amp;p)
&gt; {
&gt; 	if (p%4 == 3)
&gt; 		return a_exp_b_mod_c(a, (p+1)/4, p);
&gt; 
&gt; 	Integer q=p-1;
&gt; 	unsigned int r=0;
&gt; 	while (q%2==0)   // while q is even
&gt; 	{
&gt; 		r++;
&gt; 		q &gt;&gt;= 1;
&gt; 	}
&gt; 
&gt; 	Integer n=2;
&gt; 	while (Jacobi(n, p) != -1)
&gt; 		++n;
&gt; 
&gt; 	Integer y = a_exp_b_mod_c(n, q, p);
&gt; 	Integer x = a_exp_b_mod_c(a, (q-1)/2, p);
&gt; 	Integer b = (x.Square()%p)*a%p;
&gt; 	x = a*x%p;
&gt; 	Integer tempb, t;
&gt; 
&gt; 	while (b != 1)
&gt; 	{
&gt; 		unsigned m=0;
&gt; 		tempb = b;
&gt; 		do
&gt; 		{
&gt; 			m++;
&gt; 			b = b.Square()%p;
&gt; 			if (m==r)
&gt; 				return Integer::ZERO;
&gt; 		}
&gt; 		while (b != 1);
&gt; 
&gt; 		t = y;
&gt; 		for (unsigned i=0; i&lt;r-m-1; i++)
&gt; 			t = t.Square()%p;
&gt; 		y = t.Square()%p;
&gt; 		r = m;
&gt; 		x = x*t%p;
&gt; 		b = tempb*y%p;
&gt; 	}
&gt; 
&gt; 	assert(x.Square()%p == a);
&gt; 	return x;
&gt; }
&gt; 
&gt; &gt;   2: How to determine if a solution exists for a
&gt; &gt;      selected value of x ?
&gt; 
&gt; The Jacobi symbol tells you whether x has a square root mod p:
&gt; 
&gt; // if b is prime, then Jacobi(a, b) returns 0 if a%b==0, 1 if a is
&gt; // quadratic residue mod b, -1 otherwise
&gt; // check a number theory book for what Jacobi symbol means when b is not
&gt; // prime
&gt; 
&gt; int Jacobi(const Integer &amp;aIn, const Integer &amp;bIn)
&gt; {
&gt;     assert(bIn[0]==1);
&gt; 
&gt;     Integer b = bIn, a = aIn%bIn;
&gt;     int result = 1;
&gt; 
&gt;     while (!!a)
&gt;     {
&gt; 	unsigned i=0;
&gt; 	while (a[i]==0)
&gt; 		i++;
&gt; 	a&gt;&gt;=i;
&gt; 
&gt; 	if (i%2==1 &amp;&amp; (b%8==3 || b%8==5))
&gt; 		result = -result;
&gt; 
&gt;         if (a%4==3 &amp;&amp; b%4==3)
&gt;             result = -result;
&gt; 
&gt;         swap(a, b);
&gt;         a %= b;
&gt;     }
&gt; 
&gt;     return (b==1) ? result : 0;
&gt; }
&gt; 
&gt; &gt;   3: Is the a simpler method than find a square root ?
&gt; 
&gt; I don't think so.  Let me know if you do find one.

If you work in GF(2^m), you can use a normal basis representation
which allows you to do much faster math.  Squaring, for example,
becomes a simple rotation.

There are also very efficient algorithms for computing inverses and
solving quadratics.

These speedups currently account for most of the performance
improvements which elliptic curve systems offer over their
integer-field counterparts.

   - Mark -


--
Mark Chen 
415/341-5539
chen@chen.com
D4 99 54 2A 98 B1 48 0C  CF 95 A5 B0 6E E0 1E 1D





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li>Return to <a href="/archive/1996/08">August 1996</a><li><p>Return to <a href="/archive/1996/09">September 1996</a><li>1996-08-29 (Fri, 30 Aug 1996 07:13:53 +0800) - <a href="/archive/1996/08/002ce9e11dcb9b1e2debd88edbb26baeb1acad236c0caf62723871a6fad0f865">Elliptic Curve Y<strong>2 = x</strong>3 + a * x**2 + b</a> - <em>trollins@interactive.visa.com (Tom Rollins)</em><ul><li>1996-08-29 (Fri, 30 Aug 1996 07:37:26 +0800) - <a href="/archive/1996/08/0351784cd22765b68bebe625d0ab446497d17f6dc3e549a6e355eb9d73561b78">Re: Elliptic Curve Y<strong>2 = x</strong>3 + a * x**2 + b</a> - <em>Wei Dai &lt;weidai@eskimo.com&gt;</em><ul><li>1996-09-01 (Sun, 1 Sep 1996 12:43:41 +0800) - Re: Elliptic Curve Y<strong>2 = x</strong>3 + a * x**2 + b - <em>chen@chen.com (Mark Chen)</em></ul><li>1996-08-30 (Fri, 30 Aug 1996 17:30:09 +0800) - <a href="/archive/1996/08/41be00b0c7c71012af99c541052c3880511127c3cb9c8a1f8aede2dfdefd7c6c">Re: Elliptic Curve Y<strong>2 = x</strong>3 + a * x**2 + b</a> - <em>Justin Card &lt;Wyntermute@worldnet.att.net&gt;</em><ul><li>1996-08-30 (Sat, 31 Aug 1996 01:14:47 +0800) - <a href="/archive/1996/08/f581318633e8b83cafdcf63f721697e10daa467175b6ad82bf8edc1d748b118e">Re: Elliptic Curve Y<strong>2 = x</strong>3 + a * x**2 + b</a> - <em>trollins@interactive.visa.com (Tom Rollins)</em></ul></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
