<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="Fa0541b4ba1659aea11be34748ab595525834e70ab8cde04df26c4a0c756d51a" /><meta name="keywords" content="Fa0541b4ba1659aea11be34748ab595525834e70ab8cde04df26c4a0c756d51a, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="Fa0541b4ba1659aea11be34748ab595525834e70ab8cde04df26c4a0c756d51a" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1996/09/fa0541b4ba1659aea11be34748ab595525834e70ab8cde04df26c4a0c756d51a/" property="og:url"><meta content="2018-06-21T22:53:40+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="Fa0541b4ba1659aea11be34748ab595525834e70ab8cde04df26c4a0c756d51a"><meta name="twitter:url" content="http://localhost:4000/archive/1996/09/fa0541b4ba1659aea11be34748ab595525834e70ab8cde04df26c4a0c756d51a/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1996-09-25---re-long-how-to-break-netscapes-server-key-encryption">1996-09-25 - Re: [Long] How to break Netscape’s server key encryption</h1><h2 id="header-data">Header Data</h2><p>From: Jeff Weinstein &lt;jsw@netscape.com&gt;<br /> To: pgut001@cs.auckland.ac.nz<br /> Message Hash: fa0541b4ba1659aea11be34748ab595525834e70ab8cde04df26c4a0c756d51a<br /> Message ID: &lt;3249833B.3EEE@netscape.com&gt;<br /> Reply To: &lt;84366802803808@cs26.cs.auckland.ac.nz&gt;<br /> UTC Datetime: 1996-09-25 22:44:10 UTC<br /> Raw Date: Thu, 26 Sep 1996 06:44:10 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: Jeff Weinstein &lt;jsw@netscape.com&gt;
Date: Thu, 26 Sep 1996 06:44:10 +0800
To: pgut001@cs.auckland.ac.nz
Subject: Re: [Long] How to break Netscape's server key encryption
In-Reply-To: &lt;84366802803808@cs26.cs.auckland.ac.nz&gt;
Message-ID: &lt;3249833B.3EEE@netscape.com&gt;
MIME-Version: 1.0
Content-Type: text/plain


pgut001@cs.auckland.ac.nz wrote:
&gt; 
&gt; The Netscape server key format is very susceptible to both a dictionary attack
&gt; and to keystream recovery.  It uses the PKCS #8 format for private keys, which
&gt; provides a large amount of known plaintext at the start of the data, in
&gt; combination with RC4 without any form of IV or other preprocessing (even though
&gt; PKCS #8 recommends that PKCS #5 password-based encryption be used), which means
&gt; you can recover the first 100-odd bytes of key stream with a simple XOR (the
&gt; same stupid mistake Microsoft made with their .PWL files).  This means two
&gt; things:
&gt; 
&gt; 1. It's very simple to write a program to perform a dictionary attack on the
&gt;    server key (it took me about half an hour using cryptlib, and another half
&gt;    hour to rip the appropriate code out of cryptlib to create a standalone
&gt;    program).
&gt; 
&gt; 2. The recovered key stream from the encrypted server key can be used to
&gt;    decrypt any other resource encrypted with the server password, *without
&gt;    knowing the password*.  This is because there's enough known plaintext
&gt;    (ASN.1 objects, object identifiers, and public key components) at the start
&gt;    of the encrypted data to recover large quantities of key stream.

Peter,
  The attack you describe is indeed possible with the Netscape Commerce Server
1.x.  However current Netscape products, such as Navigator, Enterprise Server,
and FastTrack Server, have improved private key encryption that prevents
these types of attacks.  Note that the old key handling code is of the
same vintage as the random number seed code that was shown to be weak last
year (from before I got here).  I recognized this particular problem
quite some time ago, and fixed all of the products that were then in
development.

  If someone is running the old Commerce Server, and is not confident
that the file system of their server machine can not be accessed by
attackers, I would recommend that they upgrade to the FastTrack or
Enterprise servers.

	--Jeff

-- 
Jeff Weinstein - Electronic Munitions Specialist
Netscape Communication Corporation
jsw@netscape.com - http://home.netscape.com/people/jsw
Any opinions expressed above are mine.





</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1996/09">September 1996</a><li><p>1996-09-25 (Thu, 26 Sep 1996 05:42:23 +0800) - <a href="/archive/1996/09/781cf3fdedf6f857dcecf579b579447d4d3547b368230b5e3430b734beab3403">[Long] How to break Netscape’s server key encryption</a> - <em>pgut001@cs.auckland.ac.nz</em><ul><li>1996-09-25 (Thu, 26 Sep 1996 06:44:10 +0800) - Re: [Long] How to break Netscape’s server key encryption - <em>Jeff Weinstein &lt;jsw@netscape.com&gt;</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
