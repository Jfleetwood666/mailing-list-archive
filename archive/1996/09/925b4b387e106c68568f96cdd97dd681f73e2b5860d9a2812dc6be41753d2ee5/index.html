<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="shortcut icon" href="/static/img/favicons/favicon.ico" /><link rel="apple-touch-icon" sizes="57x57" href="/static/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/static/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/static/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/static/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/static/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/static/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/static/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/static/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/static/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/static/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/static/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/static/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/static/img/favicons/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><title>cryptoanarchy.wiki - Cypherpunks Mailing List Archive</title><meta name="author" content="cryptoanarchy.wiki" /><meta name="description" content="925b4b387e106c68568f96cdd97dd681f73e2b5860d9a2812dc6be41753d2ee5" /><meta name="keywords" content="925b4b387e106c68568f96cdd97dd681f73e2b5860d9a2812dc6be41753d2ee5, cryptoanarchy.wiki - Cypherpunks Mailing List Archive, " /><link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"><meta content="" property="fb:app_id"><meta content="cryptoanarchy.wiki - Cypherpunks Mailing List Archive" property="og:site_name"><meta content="925b4b387e106c68568f96cdd97dd681f73e2b5860d9a2812dc6be41753d2ee5" property="og:title"><meta content="article" property="og:type"><meta content="Arise, you have nothing to lose but your barbed wire fences!" property="og:description"><meta content="http://localhost:4000/archive/1996/09/925b4b387e106c68568f96cdd97dd681f73e2b5860d9a2812dc6be41753d2ee5/" property="og:url"><meta content="2018-06-27T00:58:45+02:00" property="article:published_time"><meta content="http://localhost:4000/about/" property="article:author"><meta content="http://localhost:4000/static/img/avatar.jpg" property="og:image"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@_cryptoanarchy"><meta name="twitter:creator" content="@_cryptoanarchy"><meta name="twitter:title" content="925b4b387e106c68568f96cdd97dd681f73e2b5860d9a2812dc6be41753d2ee5"><meta name="twitter:url" content="http://localhost:4000/archive/1996/09/925b4b387e106c68568f96cdd97dd681f73e2b5860d9a2812dc6be41753d2ee5/"><meta name="twitter:description" content="Arise, you have nothing to lose but your barbed wire fences!"><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><link rel="stylesheet" href="/static/css/syntax.css"><link href="/static/css/bootstrap.min.css" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css"><link rel="stylesheet" href="/static/css/super-search.css"><link rel="stylesheet" href="/static/css/thickbox.css"><link rel="stylesheet" href="/static/css/projects.css"><link rel="stylesheet" href="/static/css/main.css"><body><div class="container"><div class="col-sm-3"><div class="fixed-condition"> <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a><h1 class="author-name"><a href="/">cryptoanarchy.wiki</a></h1><div class="profile-about"> Arise, you have nothing to lose but your barbed wire fences!</div><div class="social"><ul><li><a href="https://twitter.com/_cryptoanarchy" target="_blank"><i class="fa fa-twitter"></i></a><li><a href="https://www.facebook.com/cryptoanarchy.wiki" target="_blank"><i class="fa fa-facebook"></i></a><li><a href="https://github.com/cryptoanarchywiki" target="_blank"><i class="fa fa-github"></i></a></ul></div><hr /><ul class="sidebar-nav"> <strong>Navigation</strong><li><a href="https://cryptoanarchy.wiki">Return to cryptoanarchy.wiki</a><li><a href="/">Archive Home</a><li><a href="/archive/">Posts by Year</a><li><a href="/authors/by-posts/">Authors by Post Number</a><li><a href="/authors/notable/">Notable Authors</a></ul><hr><ul class="sidebar-nav"> <strong>Similar Resources</strong><li><a class="about" href="https://lopp.net/bitcoin.html" target="_blank">Lopp's Bitcoin Resources</a><li><a class="about" href="https://nakamotoinstitute.org/" target="_blank">Satoshi Nakamoto Institute</a><li><a class="about" href="https://www.activism.net/cypherpunk/" target="_blank">Activism.net: Cypherpunks</a></ul></div></div><div class="col-sm-8 col-offset-1 main-layout"><h1 id="1996-09-29---re-transforming-variable-length-to-fixed-keys">1996-09-29 - Re: Transforming variable-length to fixed keys</h1><h2 id="header-data">Header Data</h2><p>From: pgut001<span>@</span>cs.auckland.ac.nz<br /> To: cypherpunks@toad.com<br /> Message Hash: 925b4b387e106c68568f96cdd97dd681f73e2b5860d9a2812dc6be41753d2ee5<br /> Message ID: &lt;84399947820692@cs26.cs.auckland.ac.nz&gt;<br /> Reply To: <em>N/A</em><br /> UTC Datetime: 1996-09-29 13:57:39 UTC<br /> Raw Date: Sun, 29 Sep 1996 21:57:39 +0800<br /><h2 id="raw-message">Raw message</h2><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>From: pgut001@cs.auckland.ac.nz
Date: Sun, 29 Sep 1996 21:57:39 +0800
To: cypherpunks@toad.com
Subject: Re: Transforming variable-length to fixed keys
Message-ID: &lt;84399947820692@cs26.cs.auckland.ac.nz&gt;
MIME-Version: 1.0
Content-Type: text/plain


&gt;If the speed of your key generation is an issue, you could do something like:
&gt;
&gt;   key[] = { 0 };
&gt;   const int nhashes = 4;
&gt;   typedef void (*hashfnptr)(byte*, byte*, int);
&gt;        /* array of hash functions */
&gt;   hashfnptr hash[ nhashes ] = { md5, sha1, haval, ... };
&gt;
&gt;   state = hash[ 0 ]( algorithm, mode, parameters, userKey );
&gt;
&gt;   for count = 1 to iterations
&gt;      for length = 1 to keyLength (in hash_output_size blocks)
&gt;                /* selecting a hash function based on the state */
&gt;         state = hash[ state % nhashes ]( state );
&gt;         key[ length ] = hash[ state % nhashes]( state, userKey );
&gt;
&gt;This provides more expense in hardware for the same expense in software, so
&gt;for the same CPU time you get more hardware expense, and could reduce the
&gt;iterations for the same security.
&gt;
&gt;`nhashes' determined by the number of digest algorithms you consider
&gt;trustworthy.
&gt;
&gt;(They need hardware for `nhashes' different digest algorithms).
&gt;
&gt;You need to do something about resolving the differing output and state sizes.
 
Yeah, that's a particularly evil way of making things harder for people with
keysearch engines.  That's why in cryptlib when I'm doing something like key
exchange I encrypt all the parameters (algorithm, mode, etc etc) along with the
session key, so an attacker can't even tell what algorithm you're using[1]. I'd
thought of adding some sort of "choose a random algorithm and mode" capability
to cryptlib, but the user interface was too difficult to handle (finding a way
to let the user specify "We want a choice of DES-CFB, IDEA-OFB, DES-EDE-CBC, or
Blowfish-PCBC" is a bit of a pain).  In the end I took the easy way out by
adding an extended initialisation mode which allows the user to specify the
algorithm if they want, but left the possibility of one-algorithm-per-round
hashing alone.  A problem with using one of a fixed selection of algorithms is
that as you add new modes the selection changes, so you need to add more state
information to the key which specifies the choice of algorithms, which starts
to get messy.
 
I'd still love to add this in some form to keep the NSA amused... perhaps a
bit vector of allowable algorithms and modes passed to the setup function.

Peter.

[1] There's a story from IBM when they were testing a new IBM-internal 
    encryption system for long-haul telecoms applications.  They were 
    playing around with bouncing encrypted transmissions off an IBM-owned 
    satellite when they were contacted by the NSA who said "You're not using 
    DES.  Stop it".







</code></pre></div></div><h2 id="thread">Thread</h2><ul><li><p>Return to <a href="/archive/1996/09">September 1996</a><li>Return to “<a href="/author/dustbin_freedom_remailer_dustman_at_athensnet_com_">Dustbin Freedom Remailer &lt;dustman<span>@</span>athensnet.com&gt;</a>”<li><p>Return to “<a href="/author/pgut001_at_cs_auckland_ac_nz">pgut001<span>@</span>cs.auckland.ac.nz</a>”<li>1996-09-29 (Sun, 29 Sep 1996 21:57:39 +0800) - Re: Transforming variable-length to fixed keys - <em>pgut001@cs.auckland.ac.nz</em><ul><li>1996-09-29 (Mon, 30 Sep 1996 06:30:14 +0800) - <a href="/archive/1996/09/1fd7a645562dc3c1b8bf594279911cd95d8dba01e4e2df306e33512ff65cd40d">Re: Transforming variable-length to fixed keys</a> - <em>Dustbin Freedom Remailer &lt;dustman@athensnet.com&gt;</em></ul></ul><footer> - <a href="https://github.com/cryptoanarchywiki/mailing-list-archive">https://github.com/cryptoanarchywiki/mailing-list-archive</a></footer></div></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script> <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script> <script src="/static/js/bootstrap.min.js"></script> <script src="/static/js/super-search.js"></script> <script src="/static/js/thickbox-compressed.js"></script> <script src="/static/js/projects.js"></script>
